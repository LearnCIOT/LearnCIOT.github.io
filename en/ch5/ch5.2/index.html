<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>

<meta property="og:title" content="5.2. Geospatial Analysis"/>
<meta property="og:description" content="We use Civil IoT Taiwan&#39;s sensor data to introduce more advanced geospatial analysis. Using the GPS location coordinates in the site information, we first use the package to find the largest convex polygon (Convex Hull) to frame the geographical area covered by the sensor. Then we apply the Voronoi Diagram package to draw the distribution status of each sensor on the map according to the sensor and crops out the area of influence of each sensor. We adopt the spatial interpolation method for the space between sensors, applying different spatial interpolation algorithms. We then populate the spatial map with values based on the sensor values and generate a corresponding image output."/>
<meta property="og:image" content="https://learnciot.github.io/images/thumbnail.jpg"/>
<meta property="og:url" content="/en/ch5/ch5.2/"/>
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="627" />
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.104.3">
    <meta name="generator" content="Relearn 5.3.3+tip">
    <meta name="description" content="We use Civil IoT Taiwan&#39;s sensor data to introduce more advanced geospatial analysis. Using the GPS location coordinates in the site information, we first use the package to find the largest convex polygon (Convex Hull) to frame the geographical area covered by the sensor. Then we apply the Voronoi Diagram package to draw the distribution status of each sensor on the map according to the sensor and crops out the area of influence of each sensor. We adopt the spatial interpolation method for the space between sensors, applying different spatial interpolation algorithms. We then populate the spatial map with values based on the sensor values and generate a corresponding image output.">
    <meta name="author" content="Ling-Jyh Chen">
    <title>5.2. Geospatial Analysis :: Tutorial for CIoT Open Data Applications</title>
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/css/fontawesome-all.min.css?1700097412" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1700097412" rel="stylesheet"></noscript>
    <link href="/css/featherlight.min.css?1700097412" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/featherlight.min.css?1700097412" rel="stylesheet"></noscript>
    <link href="/css/auto-complete.css?1700097412" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1700097412" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1700097412" rel="stylesheet">
    <link href="/css/nucleus.css?1700097412" rel="stylesheet">
    <link href="/css/fonts.css?1700097412" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1700097412" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1700097412" rel="stylesheet">
    <link href="/css/theme-relearn-light.css?1700097412" rel="stylesheet" id="variant-style">
    <link href="/css/ie.css?1700097412" rel="stylesheet">
    <link href="/css/variant.css?1700097412" rel="stylesheet">
    <link href="/css/print.css?1700097412" rel="stylesheet" media="print">
    <script src="/js/variant.js?1700097412"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      var index_url="/en/index.json";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      // some further base stuff
      var baseUriFull='https:\/\/LearnCIOT.github.io/';
      window.variants && variants.init( [ 'relearn-light' ] );
    </script>
    <script src="/js/jquery.min.js?1700097412" defer></script>
<meta property="fb:app_id" content="601826851395774" />
  </head>
  <body class="default-animation" data-url="/en/ch5/ch5.2/">




<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v14.0" nonce="hWjBXHAv"></script>

    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable">
        <div>
          <div class="navigation">
             <a class="nav nav-next" href="/en/ch6/" title="6. Data Applications"><i class="fas fa-chevron-right fa-fw"></i></a>
          </div>
          <div class="navigation">
             <a class="nav nav-prev" href="/en/ch5/ch5.1/" title="5.1. Geospatial Filtering"><i class="fas fa-chevron-left fa-fw"></i></a>
          </div>
          <div id="top-github-link">
            <a class="github-link" title='Edit' href="https://github.com/LearnCIOT/LearnCIOT.github.io/tree/main/content/ch5/ch5.2/index.en.md" target="blank">
              <i class="fas fa-pen fa-fw"></i>
            </a>
          </div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menu'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <span id="toc-menu" title='Table of Contents'><i class="fas fa-list-alt fa-fw"></i></span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <meta itemprop="itemListOrder" content="Descending" />
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="3" /><a itemprop="item" href="/en/"><span itemprop="name">Learning Civil IoT Taiwan Open Data and Its Applications</span></a> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="2" /><a itemprop="item" href="/en/ch5/"><span itemprop="name">5. Spatial Data Analysis</span></a> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="1" /><a itemprop="item" href="/en/ch5/ch5.2/" aria-disabled="true"><span itemprop="name">5.2. Geospatial Analysis</span></a></li>
            </ol>
          </div>
          <div class="default-animation progress">
            <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#voronoi-diagram">Voronoi diagram</a></li>
    <li><a href="#convex-hull">Convex hull</a></li>
    <li><a href="#clustering">Clustering</a></li>
    <li><a href="#kernel-density">Kernel density</a></li>
    <li><a href="#spatial-interpolation">Spatial interpolation</a>
      <ul>
        <li><a href="#inverse-distance-weighting">Inverse Distance Weighting</a></li>
        <li><a href="#kriging">Kriging</a></li>
        <li><a href="#nearest-neighbor-interpolation">Nearest neighbor Interpolation</a></li>
      </ul>
    </li>
    <li><a href="#contour">Contour</a>
      <ul>
        <li><a href="#profile">Profile</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
            </div>
          </div>
        </div>
      </nav>

      <main id="body-inner" class="highlightable ">
        <div class="flex-block-wrapper">
          <div id="head-tags"><div class="tags">
  <a class="level-link" href="/en/levels/intermediate">
  <b>
	&starf;&starf;&starf;&star;&star;
  </b>
  </a>
  <a class="tag-link" href="/en/tags/air">Air</a>
  <a class="tag-link" href="/en/tags/python">Python</a>
  <a class="tag-link" href="/en/tags/water">Water</a>
</div>

          </div>


  
  
  

  <section class="social-share">
    <ul class="share-icons">
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?hashtags=codingnconcepts&amp;url=https%3a%2f%2fLearnCIOT.github.io%2fen%2fch5%2fch5.2%2f&amp;text=5.2.%20Geospatial%20Analysis" target="_blank" rel="noopener" aria-label="Share on Twitter" class="share-btn twitter">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="26px" viewBox="0 0 31 26" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(11.372549%,60.784314%,94.117647%);fill-opacity:1;" d="M 27.742188 6.535156 C 27.761719 6.8125 27.761719 7.089844 27.761719 7.371094 C 27.761719 15.875 21.414062 25.683594 9.800781 25.683594 L 9.800781 25.675781 C 6.371094 25.683594 3.011719 24.679688 0.125 22.792969 C 0.625 22.851562 1.125 22.882812 1.628906 22.886719 C 4.46875 22.886719 7.230469 21.914062 9.46875 20.125 C 6.765625 20.070312 4.398438 18.277344 3.570312 15.65625 C 4.515625 15.839844 5.492188 15.800781 6.421875 15.542969 C 3.476562 14.9375 1.355469 12.300781 1.355469 9.234375 L 1.355469 9.152344 C 2.234375 9.652344 3.214844 9.929688 4.222656 9.960938 C 1.449219 8.070312 0.59375 4.304688 2.265625 1.363281 C 5.472656 5.386719 10.203125 7.832031 15.277344 8.089844 C 14.769531 5.855469 15.464844 3.511719 17.105469 1.941406 C 19.644531 -0.496094 23.644531 -0.371094 26.035156 2.21875 C 27.449219 1.933594 28.804688 1.40625 30.042969 0.65625 C 29.574219 2.144531 28.585938 3.410156 27.269531 4.214844 C 28.519531 4.066406 29.742188 3.722656 30.894531 3.203125 C 30.046875 4.496094 28.980469 5.625 27.742188 6.535156 Z M 27.742188 6.535156 "/>
</g>
</svg>

          <p>Twitter</p>
          </a>
      </li>
      

      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fLearnCIOT.github.io%2fen%2fch5%2fch5.2%2f" target="_blank" rel="noopener" aria-label="Share on Facebook" class="share-btn facebook">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="32px" viewBox="0 0 32 32" version="1.1">
<defs>
<linearGradient id="linear0" gradientUnits="userSpaceOnUse" x1="-277.375" y1="406.6018" x2="-277.375" y2="407.5726" gradientTransform="matrix(32,0,0,-31.82224,8892.0008,12969.8672)">
<stop offset="0" style="stop-color:rgb(0%,38.431373%,87.843137%);stop-opacity:1;"/>
<stop offset="1" style="stop-color:rgb(9.803922%,68.627451%,100%);stop-opacity:1;"/>
</linearGradient>
</defs>
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:url(#linear0);" d="M 13.359375 31.839844 C 5.761719 30.480469 0 23.921875 0 16 C 0 7.199219 7.199219 0 16 0 C 24.800781 0 32 7.199219 32 16 C 32 23.921875 26.238281 30.480469 18.640625 31.839844 L 17.761719 31.121094 L 14.238281 31.121094 Z M 13.359375 31.839844 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 22.238281 20.480469 L 22.960938 16 L 18.71875 16 L 18.71875 12.878906 C 18.71875 11.601562 19.199219 10.640625 21.121094 10.640625 L 23.199219 10.640625 L 23.199219 6.558594 C 22.078125 6.398438 20.800781 6.238281 19.679688 6.238281 C 16 6.238281 13.441406 8.480469 13.441406 12.480469 L 13.441406 16 L 9.441406 16 L 9.441406 20.480469 L 13.441406 20.480469 L 13.441406 31.761719 C 14.320312 31.921875 15.199219 32 16.078125 32 C 16.960938 32 17.839844 31.921875 18.71875 31.761719 L 18.71875 20.480469 Z M 22.238281 20.480469 "/>
</g>
</svg>

          <p>Facebook</p>
          </a>
      </li>
      

      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fLearnCIOT.github.io%2fen%2fch5%2fch5.2%2f&amp;source=https%3a%2f%2fLearnCIOT.github.io%2fen%2fch5%2fch5.2%2f&amp;title=5.2.%20Geospatial%20Analysis&amp;summary=5.2.%20Geospatial%20Analysis" target="_blank" rel="noopener" aria-label="Share on LinkedIn" class="share-btn linkedin">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="32px" viewBox="0 0 32 32" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:evenodd;fill:rgb(0%,49.411765%,73.333333%);fill-opacity:1;" d="M 16 32 C 24.835938 32 32 24.835938 32 16 C 32 7.164062 24.835938 0 16 0 C 7.164062 0 0 7.164062 0 16 C 0 24.835938 7.164062 32 16 32 Z M 16 32 "/>
<path style=" stroke:none;fill-rule:evenodd;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 26.222656 25.332031 L 22.203125 25.332031 L 22.203125 18.488281 C 22.203125 16.613281 21.492188 15.566406 20.007812 15.566406 C 18.390625 15.566406 17.546875 16.65625 17.546875 18.488281 L 17.546875 25.332031 L 13.675781 25.332031 L 13.675781 12.296875 L 17.546875 12.296875 L 17.546875 14.050781 C 17.546875 14.050781 18.710938 11.898438 21.476562 11.898438 C 24.242188 11.898438 26.222656 13.585938 26.222656 17.078125 Z M 9.054688 10.589844 C 7.734375 10.589844 6.667969 9.511719 6.667969 8.183594 C 6.667969 6.855469 7.734375 5.777344 9.054688 5.777344 C 10.375 5.777344 11.441406 6.855469 11.441406 8.183594 C 11.441406 9.511719 10.375 10.589844 9.054688 10.589844 Z M 7.054688 25.332031 L 11.09375 25.332031 L 11.09375 12.296875 L 7.054688 12.296875 Z M 7.054688 25.332031 "/>
</g>
</svg>

            <p>LinkedIn</p>
          </a>
      </li>
      

      
      
      <li>
        <a href="whatsapp://send?text=5.2.%20Geospatial%20Analysis%2c%20by%20Tutorial%20for%20CIoT%20Open%20Data%20Applications%0aWe%20use%20Civil%20IoT%20Taiwan%27s%20sensor%20data%20to%20introduce%20more%20advanced%20geospatial%20analysis.%20Using%20the%20GPS%20location%20coordinates%20in%20the%20site%20information%2c%20we%20first%20use%20the%20package%20to%20find%20the%20largest%20convex%20polygon%20%28Convex%20Hull%29%20to%20frame%20the%20geographical%20area%20covered%20by%20the%20sensor.%20Then%20we%20apply%20the%20Voronoi%20Diagram%20package%20to%20draw%20the%20distribution%20status%20of%20each%20sensor%20on%20the%20map%20according%20to%20the%20sensor%20and%20crops%20out%20the%20area%20of%20influence%20of%20each%20sensor.%20We%20adopt%20the%20spatial%20interpolation%20method%20for%20the%20space%20between%20sensors%2c%20applying%20different%20spatial%20interpolation%20algorithms.%20We%20then%20populate%20the%20spatial%20map%20with%20values%20based%20on%20the%20sensor%20values%20and%20generate%20a%20corresponding%20image%20output.%0a%0ahttps%3a%2f%2fLearnCIOT.github.io%2fen%2fch5%2fch5.2%2f%0a" target="_blank" class="share-btn whatsapp">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="32px" viewBox="0 0 32 32" version="1.1">
<defs>
<image id="image5" width="588" height="590" xlink:href="data:image/png;base64,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"/>
</defs>
<g id="surface2">
<use xlink:href="#image5" transform="matrix(0.054145,0,0,0.054145,0.054145,0)"/>
<path style=" stroke:none;fill-rule:evenodd;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 24.355469 7.726562 C 22.222656 5.585938 19.378906 4.410156 16.355469 4.40625 C 10.117188 4.40625 5.042969 9.484375 5.042969 15.71875 C 5.039062 17.714844 5.5625 19.660156 6.550781 21.375 L 4.945312 27.238281 L 10.945312 25.664062 C 12.597656 26.566406 14.457031 27.039062 16.351562 27.042969 L 16.355469 27.042969 C 22.589844 27.042969 27.664062 21.964844 27.667969 15.730469 C 27.667969 12.707031 26.492188 9.863281 24.355469 7.726562 Z M 16.355469 25.132812 L 16.351562 25.132812 C 14.664062 25.128906 13.007812 24.675781 11.566406 23.820312 L 11.222656 23.617188 L 7.664062 24.550781 L 8.613281 21.082031 L 8.390625 20.722656 C 7.449219 19.226562 6.949219 17.496094 6.953125 15.71875 C 6.953125 10.535156 11.171875 6.320312 16.359375 6.320312 C 18.871094 6.320312 21.230469 7.296875 23.003906 9.074219 C 24.78125 10.851562 25.757812 13.214844 25.757812 15.726562 C 25.753906 20.914062 21.535156 25.132812 16.355469 25.132812 Z M 21.511719 18.089844 C 21.230469 17.945312 19.839844 17.261719 19.582031 17.167969 C 19.320312 17.074219 19.132812 17.027344 18.945312 17.3125 C 18.757812 17.59375 18.214844 18.230469 18.050781 18.417969 C 17.882812 18.609375 17.71875 18.632812 17.4375 18.488281 C 17.152344 18.347656 16.242188 18.050781 15.164062 17.085938 C 14.324219 16.335938 13.757812 15.410156 13.589844 15.128906 C 13.425781 14.84375 13.574219 14.691406 13.714844 14.550781 C 13.84375 14.425781 13.996094 14.222656 14.140625 14.054688 C 14.28125 13.890625 14.328125 13.773438 14.421875 13.585938 C 14.515625 13.394531 14.46875 13.230469 14.398438 13.089844 C 14.328125 12.949219 13.761719 11.554688 13.527344 10.992188 C 13.296875 10.441406 13.066406 10.515625 12.890625 10.503906 C 12.726562 10.496094 12.539062 10.496094 12.347656 10.496094 C 12.160156 10.496094 11.855469 10.566406 11.59375 10.847656 C 11.335938 11.132812 10.605469 11.816406 10.605469 13.207031 C 10.605469 14.597656 11.617188 15.941406 11.761719 16.132812 C 11.902344 16.320312 13.753906 19.175781 16.589844 20.398438 C 17.261719 20.691406 17.789062 20.863281 18.199219 20.996094 C 18.878906 21.210938 19.492188 21.179688 19.980469 21.105469 C 20.523438 21.027344 21.652344 20.421875 21.890625 19.761719 C 22.125 19.101562 22.125 18.535156 22.054688 18.417969 C 21.984375 18.300781 21.792969 18.230469 21.511719 18.089844 Z M 21.511719 18.089844 "/>
</g>
</svg>

          <p>Email</p>
        </a>
      </li>
      

      
      
      <li>
        <a href="mailto:?subject=Tutorial%20for%20CIoT%20Open%20Data%20Applications - 5.2.%20Geospatial%20Analysis.&amp;body=5.2.%20Geospatial%20Analysis%2c%20by%20Tutorial%20for%20CIoT%20Open%20Data%20Applications%0aWe%20use%20Civil%20IoT%20Taiwan%27s%20sensor%20data%20to%20introduce%20more%20advanced%20geospatial%20analysis.%20Using%20the%20GPS%20location%20coordinates%20in%20the%20site%20information%2c%20we%20first%20use%20the%20package%20to%20find%20the%20largest%20convex%20polygon%20%28Convex%20Hull%29%20to%20frame%20the%20geographical%20area%20covered%20by%20the%20sensor.%20Then%20we%20apply%20the%20Voronoi%20Diagram%20package%20to%20draw%20the%20distribution%20status%20of%20each%20sensor%20on%20the%20map%20according%20to%20the%20sensor%20and%20crops%20out%20the%20area%20of%20influence%20of%20each%20sensor.%20We%20adopt%20the%20spatial%20interpolation%20method%20for%20the%20space%20between%20sensors%2c%20applying%20different%20spatial%20interpolation%20algorithms.%20We%20then%20populate%20the%20spatial%20map%20with%20values%20based%20on%20the%20sensor%20values%20and%20generate%20a%20corresponding%20image%20output.%0a%0ahttps%3a%2f%2fLearnCIOT.github.io%2fen%2fch5%2fch5.2%2f%0a" target="_blank" class="share-btn email">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="32px" viewBox="0 0 32 32" version="1.1">
<defs>
<filter id="alpha" filterUnits="objectBoundingBox" x="0%" y="0%" width="100%" height="100%">
  <feColorMatrix type="matrix" in="SourceGraphic" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0"/>
</filter>
<mask id="mask0">
  <g filter="url(#alpha)">
<rect x="0" y="0" width="32" height="32" style="fill:rgb(0%,0%,0%);fill-opacity:0.2;stroke:none;"/>
  </g>
</mask>
<clipPath id="clip1">
  <rect x="0" y="0" width="32" height="32"/>
</clipPath>
<g id="surface5" clip-path="url(#clip1)">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(13.72549%,12.156863%,12.54902%);fill-opacity:1;" d="M 26 22 C 26 23.101562 25.101562 24 24 24 L 8 24 C 6.898438 24 6 23.101562 6 22 L 6 12 C 6 10.898438 6.898438 10 8 10 L 24 10 C 25.101562 10 26 10.898438 26 12 Z M 26 22 "/>
</g>
<mask id="mask1">
  <g filter="url(#alpha)">
<rect x="0" y="0" width="32" height="32" style="fill:rgb(0%,0%,0%);fill-opacity:0.2;stroke:none;"/>
  </g>
</mask>
<clipPath id="clip2">
  <rect x="0" y="0" width="32" height="32"/>
</clipPath>
<g id="surface8" clip-path="url(#clip2)">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(13.72549%,12.156863%,12.54902%);fill-opacity:1;" d="M 17.75 15.101562 C 16.800781 14.050781 15.199219 14.050781 14.25 15.101562 L 6.5 21.601562 C 6.398438 21.699219 6.351562 21.800781 6.25 21.898438 C 6.601562 22.550781 7.25 23 7.949219 23 L 23.949219 23 C 24.699219 23 25.300781 22.550781 25.648438 21.898438 C 25.601562 21.800781 25.5 21.699219 25.398438 21.601562 Z M 17.75 15.101562 "/>
</g>
<mask id="mask2">
  <g filter="url(#alpha)">
<rect x="0" y="0" width="32" height="32" style="fill:rgb(0%,0%,0%);fill-opacity:0.2;stroke:none;"/>
  </g>
</mask>
<clipPath id="clip3">
  <rect x="0" y="0" width="32" height="32"/>
</clipPath>
<g id="surface11" clip-path="url(#clip3)">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(13.72549%,12.156863%,12.54902%);fill-opacity:1;" d="M 6.300781 10.101562 C 6.648438 9.449219 7.300781 9 8 9 L 24 9 C 24.75 9 25.351562 9.449219 25.699219 10.101562 C 25.648438 10.199219 25.550781 10.300781 25.449219 10.398438 L 17.75 16.898438 C 16.800781 17.949219 15.199219 17.949219 14.25 16.898438 Z M 6.300781 10.101562 "/>
</g>
</defs>
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(46.666667%,70.196078%,83.137255%);fill-opacity:1;" d="M 32 16 C 32 24.835938 24.835938 32 16 32 C 7.164062 32 0 24.835938 0 16 C 0 7.164062 7.164062 0 16 0 C 24.835938 0 32 7.164062 32 16 Z M 32 16 "/>
<use xlink:href="#surface5" mask="url(#mask0)"/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(87.843137%,87.843137%,81.960784%);fill-opacity:1;" d="M 26 21 C 26 22.101562 25.101562 23 24 23 L 8 23 C 6.898438 23 6 22.101562 6 21 L 6 11 C 6 9.898438 6.898438 9 8 9 L 24 9 C 25.101562 9 26 9.898438 26 11 Z M 26 21 "/>
<use xlink:href="#surface8" mask="url(#mask1)"/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(87.843137%,87.843137%,81.960784%);fill-opacity:1;" d="M 17.75 16 C 16.800781 15.050781 15.199219 15.050781 14.25 16 L 6.5 21.75 C 6.398438 21.851562 6.351562 21.898438 6.25 22 C 6.601562 22.601562 7.25 22.949219 7.949219 22.949219 L 23.949219 22.949219 C 24.699219 22.949219 25.300781 22.550781 25.648438 22 C 25.601562 21.898438 25.5 21.851562 25.398438 21.75 Z M 17.75 16 "/>
<use xlink:href="#surface11" mask="url(#mask2)"/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 14.25 16 C 15.199219 16.949219 16.800781 16.949219 17.75 16 L 25.5 10.25 C 25.601562 10.148438 25.648438 10.101562 25.75 10 C 25.398438 9.398438 24.75 9.050781 24.050781 9.050781 L 8 9.050781 C 7.25 9.050781 6.648438 9.449219 6.300781 10 C 6.351562 10.101562 6.449219 10.148438 6.550781 10.25 Z M 14.25 16 "/>
</g>
</svg>

          <p>Email</p>
        </a>
      </li>
    </ul>
  </section>
  



<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZCH7EJS8LE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-ZCH7EJS8LE', { 'anonymize_ip': false });
}
</script>



          <article class="default">
<h1>5.2. Geospatial Analysis</h1>

<p><a href="https://colab.research.google.com/drive/1dZ26qA1BLee7AMaoBk0lcWvB3PAOLKV-?usp=sharing"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>
<div>
    <h2>Table Of Contents</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#voronoi-diagram">Voronoi diagram</a></li>
    <li><a href="#convex-hull">Convex hull</a></li>
    <li><a href="#clustering">Clustering</a></li>
    <li><a href="#kernel-density">Kernel density</a></li>
    <li><a href="#spatial-interpolation">Spatial interpolation</a>
      <ul>
        <li><a href="#inverse-distance-weighting">Inverse Distance Weighting</a></li>
        <li><a href="#kriging">Kriging</a></li>
        <li><a href="#nearest-neighbor-interpolation">Nearest neighbor Interpolation</a></li>
      </ul>
    </li>
    <li><a href="#contour">Contour</a>
      <ul>
        <li><a href="#profile">Profile</a></li>
      </ul>
    </li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
</div>

<p>Microsensors that are widespread in the environment help us obtain environmental information, making decisions and taking actions accordingly. Therefore, it’s fundamental for us to clearly understand the spatial relationships between stations when analyzing data of stations. Apart from that the location of stations itself may form certain geometric structures or spatial clusters, we can also estimate the values where there’s no stations according to the location of stations and their value differences. Thus, we will have a picture of value distribution that’s more comprehensive, within which we may explore the correlations between values and environmental factors. In this section, with data of flooding sensors and groundwater table observation stations in different counties provided by the Water Resources Agency (MOEA), we can practice some simple spatial analyses.</p>
<h2 id="voronoi-diagram">Voronoi diagram</h2>
<p>First of all, we may need to clarify the service/defense area of individual stations, within which we further ask if data of certain stations can represent certain areas. In this case, Voronoi Diagram can help us look for the area. The principle of Voronoi Diagram is that by building vertical and equally divided lines between two nearby stations and integrating them, a polygon can be made. The center of each polygon is the station, of which the data represent values within this area. In this section, we can try to practice creating Voronoi Diagrams with data of flooding sensors in Chiayi City and Chiayi County. Thus, we can have a rough understanding about the sphere of influence of flooding sensors.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib.request
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> ssl
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#75715e">#install geopython libraries</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>apt install gdal<span style="color:#f92672">-</span>bin python<span style="color:#f92672">-</span>gdal python3<span style="color:#f92672">-</span>gdal
</span></span><span style="display:flex;"><span><span style="color:#75715e">#install python3-rtree - Geopandas requirement</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>apt install python3<span style="color:#f92672">-</span>rtree 
</span></span><span style="display:flex;"><span><span style="color:#75715e">#install geopandas</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install geopandas
</span></span><span style="display:flex;"><span><span style="color:#75715e">#install pykrige</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install pykrige
</span></span><span style="display:flex;"><span><span style="color:#75715e">#install elevation</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install elevation
</span></span><span style="display:flex;"><span><span style="color:#75715e">#install affine rasterio</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install affine rasterio
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#install descartes - Geopandas requirement</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install descartes
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> geopandas <span style="color:#66d9ef">as</span> gpd
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install pyCIOT
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pyCIOT.data <span style="color:#66d9ef">as</span> CIoT
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># downlaod the county boundary shpfile from open database</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O <span style="color:#e6db74">&#34;shp.zip&#34;</span> <span style="color:#f92672">-</span>q <span style="color:#e6db74">&#34;https://data.moi.gov.tw/MoiOD/System/DownloadFile.aspx?DATA=72874C55-884D-4CEA-B7D6-F60B0BE85AB0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>unzip shp<span style="color:#f92672">.</span>zip <span style="color:#f92672">-</span>d shp
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># # get flood sensors&#39; data by pyCIOT</span>
</span></span><span style="display:flex;"><span>wa <span style="color:#f92672">=</span> CIoT<span style="color:#f92672">.</span>Water()<span style="color:#f92672">.</span>get_data(src<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FLOODING:WRA&#34;</span>)
</span></span><span style="display:flex;"><span>wa2 <span style="color:#f92672">=</span> CIoT<span style="color:#f92672">.</span>Water()<span style="color:#f92672">.</span>get_data(src<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;FLOODING:WRA2&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flood_list <span style="color:#f92672">=</span> wa <span style="color:#f92672">+</span> wa2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>county <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>read_file(<span style="color:#e6db74">&#39;/content/shp/COUNTY_MOI_1090820.shp&#39;</span>)
</span></span><span style="display:flex;"><span>basemap <span style="color:#f92672">=</span> county<span style="color:#f92672">.</span>loc[county[<span style="color:#e6db74">&#39;COUNTYNAME&#39;</span>]<span style="color:#f92672">.</span>isin([<span style="color:#e6db74">&#34;嘉義縣&#34;</span>,<span style="color:#e6db74">&#34;嘉義市&#34;</span>])]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flood_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([],columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;name&#39;</span>,  <span style="color:#e6db74">&#39;Observations&#39;</span>,<span style="color:#e6db74">&#39;lon&#39;</span>, <span style="color:#e6db74">&#39;lat&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> flood_list:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#print(i[&#39;data&#39;][0])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(i[<span style="color:#e6db74">&#39;data&#39;</span>])<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([[i[<span style="color:#e6db74">&#39;properties&#39;</span>][<span style="color:#e6db74">&#39;stationName&#39;</span>],i[<span style="color:#e6db74">&#39;data&#39;</span>][<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;values&#39;</span>][<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;value&#39;</span>],i[<span style="color:#e6db74">&#39;location&#39;</span>][<span style="color:#e6db74">&#39;longitude&#39;</span>],i[<span style="color:#e6db74">&#39;location&#39;</span>][<span style="color:#e6db74">&#39;latitude&#39;</span>]]],columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;name&#39;</span>,  <span style="color:#e6db74">&#39;Observations&#39;</span>,<span style="color:#e6db74">&#39;lon&#39;</span>, <span style="color:#e6db74">&#39;lat&#39;</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> :
</span></span><span style="display:flex;"><span>        df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([[i[<span style="color:#e6db74">&#39;properties&#39;</span>][<span style="color:#e6db74">&#39;stationName&#39;</span>],<span style="color:#f92672">-</span><span style="color:#ae81ff">999</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">999</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">999</span>]],columns <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;name&#39;</span>,  <span style="color:#e6db74">&#39;Observations&#39;</span>,<span style="color:#e6db74">&#39;lon&#39;</span>, <span style="color:#e6db74">&#39;lat&#39;</span>])
</span></span><span style="display:flex;"><span>    flood_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([flood_df,df])
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#print(df)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result_df <span style="color:#f92672">=</span> flood_df<span style="color:#f92672">.</span>drop_duplicates(subset<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;name&#39;</span>], keep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;first&#39;</span>)
</span></span><span style="display:flex;"><span>station<span style="color:#f92672">=</span>result_df<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;lon&#39;</span>, <span style="color:#e6db74">&#39;lat&#39;</span>])
</span></span><span style="display:flex;"><span>station <span style="color:#f92672">=</span> station[station<span style="color:#f92672">.</span>lon<span style="color:#f92672">!=-</span><span style="color:#ae81ff">999</span>]
</span></span><span style="display:flex;"><span>station<span style="color:#f92672">.</span>reset_index(inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, drop<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>gdf_flood <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>GeoDataFrame(
</span></span><span style="display:flex;"><span>    station, geometry<span style="color:#f92672">=</span>gpd<span style="color:#f92672">.</span>points_from_xy(station<span style="color:#f92672">.</span>lon, station<span style="color:#f92672">.</span>lat),crs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;EPSG:4326&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>station<span style="color:#f92672">=</span>result_df<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;lon&#39;</span>, <span style="color:#e6db74">&#39;lat&#39;</span>])
</span></span><span style="display:flex;"><span>station <span style="color:#f92672">=</span> station[station<span style="color:#f92672">.</span>lon<span style="color:#f92672">!=-</span><span style="color:#ae81ff">999</span>]
</span></span><span style="display:flex;"><span>station<span style="color:#f92672">.</span>reset_index(inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, drop<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>gdf_flood <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>GeoDataFrame(
</span></span><span style="display:flex;"><span>    station, geometry<span style="color:#f92672">=</span>gpd<span style="color:#f92672">.</span>points_from_xy(station<span style="color:#f92672">.</span>lon, station<span style="color:#f92672">.</span>lat),crs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;EPSG:4326&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>basemap <span style="color:#f92672">=</span> basemap<span style="color:#f92672">.</span>set_crs(<span style="color:#ae81ff">4326</span>,allow_override<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>intersected_data <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>overlay(gdf_flood, basemap, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;intersection&#39;</span>) 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.spatial <span style="color:#f92672">import</span> Voronoi, voronoi_plot_2d
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>inputp <span style="color:#f92672">=</span> intersected_data[[<span style="color:#e6db74">&#39;lon&#39;</span>,<span style="color:#e6db74">&#39;lat&#39;</span>]]
</span></span><span style="display:flex;"><span>basemap<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax, facecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;none&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;purple&#39;</span>);
</span></span><span style="display:flex;"><span>vor <span style="color:#f92672">=</span> Voronoi(inputp)
</span></span><span style="display:flex;"><span>voronoi_plot_2d(vor,ax <span style="color:#f92672">=</span> ax,show_vertices<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>,)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/5-2-1-1.png" alt="Python output"></p>
<p>Besides, we can describe the service/defense areas of stations with Delaunay Triangulation, with which we choose one station as the center and search for two nearest dots to create a triangular service area. If we consider the triangular service area as a homogeneous sphere, in which data of sensors can be replaced with the average values obtained from the three nodal stations.</p>
<p>Overall, the two algorithms can help us understand the spatial distribution of sensors and the spatial structure it constructs as graphics.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.spatial <span style="color:#f92672">import</span> Delaunay, delaunay_plot_2d
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e">#input should be array</span>
</span></span><span style="display:flex;"><span>inputp <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(inputp)
</span></span><span style="display:flex;"><span>tri <span style="color:#f92672">=</span> Delaunay(inputp)
</span></span><span style="display:flex;"><span>basemap<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax, facecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;none&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;purple&#39;</span>);
</span></span><span style="display:flex;"><span>delaunay_plot_2d(tri,ax<span style="color:#f92672">=</span>ax)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/5-2-1-2.png" alt="Python output"></p>
<h2 id="convex-hull">Convex hull</h2>
<p>The algorithm of Convex Hull aims at selecting stations located at marginal areas from a group of stations, and form a polygon with smallest side lengths while containing all points. Therefore, we can locate the clustering range among many stations, with which more calculation can be done. To compute the algorithm of Convex Hull, we basically have to arrange the order of stations according to their x coordinates; if the x coordinates are identical, we can use y coordinates for arrangement to find out the peripheral endpoints to form polygons. (Of course, there are many other methods applying similar concepts.) With such an algorithm, we can evaluate the effective inspection areas of stations. Accordingly, we can examine the covering area of flooding sensors with data of their distribution in Chiayi City and Chiayi County.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.spatial <span style="color:#f92672">import</span> ConvexHull, convex_hull_plot_2d
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>hull <span style="color:#f92672">=</span> ConvexHull(inputp)
</span></span><span style="display:flex;"><span>basemap<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax, facecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;none&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;purple&#39;</span>);
</span></span><span style="display:flex;"><span>convex_hull_plot_2d(hull,ax<span style="color:#f92672">=</span>ax)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span></code></pre></div><p><img src="figures/5-2-2-1.png" alt="Python output"></p>
<h2 id="clustering">Clustering</h2>
<p>As explained above, the nearer the stations are, the more similar the interfering factors in surrounding environments are. So, with K-means algorithm serving as a partitioning method, we can partition stations into clusters to explore the relationship between sensor data and environmental factors.</p>
<p>After we decide to partition our observations into n clusters, K-means clustering will randomly select n points as centers to search for their nearby neighbors; by measuring the linear distance between observation points and their centers, K-means clustering partitions the observation points and calculates the average of each cluster. Repeating the procedure above, K-means clustering aims to minimize average distances between all observation points and their centers, and the partitioning will be finished once the distance becomes shortest.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># get the groundwater station data through pyCIOT</span>
</span></span><span style="display:flex;"><span>count <span style="color:#f92672">=</span> <span style="color:#ae81ff">733</span>
</span></span><span style="display:flex;"><span>num <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>water_level <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame([])
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span>(num<span style="color:#f92672">&lt;=</span>count):
</span></span><span style="display:flex;"><span>    url_level <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://sta.ci.taiwan.gov.tw/STA_WaterResource_v2/v1.0/Datastreams?$skip=&#34;</span><span style="color:#f92672">+</span>str(num)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;&amp;$filter=</span><span style="color:#e6db74">%28%</span><span style="color:#e6db74">28Thing</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">properties</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">authority_type+eq+</span><span style="color:#e6db74">%27%</span><span style="color:#e6db74">E6%B0%B4</span><span style="color:#e6db74">%E</span><span style="color:#e6db74">5</span><span style="color:#e6db74">%88%</span><span style="color:#e6db74">A9</span><span style="color:#e6db74">%E</span><span style="color:#e6db74">7%BD%B2</span><span style="color:#e6db74">%27%</span><span style="color:#e6db74">29+and+substringof</span><span style="color:#e6db74">%28%</span><span style="color:#e6db74">27Datastream_Category_type%3D</span><span style="color:#e6db74">%E</span><span style="color:#e6db74">5%9C%B0</span><span style="color:#e6db74">%E</span><span style="color:#e6db74">4%B8%8B</span><span style="color:#e6db74">%E</span><span style="color:#e6db74">6%B0%B4</span><span style="color:#e6db74">%E</span><span style="color:#e6db74">4%BD%8D</span><span style="color:#e6db74">%E</span><span style="color:#e6db74">7%AB</span><span style="color:#e6db74">%99%</span><span style="color:#e6db74">27%2CDatastreams</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">description</span><span style="color:#e6db74">%29%</span><span style="color:#e6db74">29&amp;$expand=Thing,Thing</span><span style="color:#e6db74">%28%</span><span style="color:#e6db74">24expand%3DLocations%29,Observations</span><span style="color:#e6db74">%28%</span><span style="color:#e6db74">24top%3D1%3B</span><span style="color:#e6db74">%24o</span><span style="color:#e6db74">rderby%3DphenomenonTime+desc%3B%24top%3D1%29&amp;$count=true&#34;</span>
</span></span><span style="display:flex;"><span>    ssl<span style="color:#f92672">.</span>_create_default_https_context <span style="color:#f92672">=</span> ssl<span style="color:#f92672">.</span>_create_unverified_context
</span></span><span style="display:flex;"><span>    r_l <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(url_level)
</span></span><span style="display:flex;"><span>    string_l <span style="color:#f92672">=</span> r_l<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;utf-8&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    jf_level <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(string_l)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    station <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(jf_level[<span style="color:#e6db74">&#39;value&#39;</span>])<span style="color:#f92672">.</span>filter(items<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Thing&#39;</span>,<span style="color:#e6db74">&#39;observedArea&#39;</span>,<span style="color:#e6db74">&#39;Observations&#39;</span>])
</span></span><span style="display:flex;"><span>    station[<span style="color:#e6db74">&#39;lat&#39;</span>]<span style="color:#f92672">=</span>station[<span style="color:#e6db74">&#39;observedArea&#39;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(station)):
</span></span><span style="display:flex;"><span>        station[<span style="color:#e6db74">&#39;Thing&#39;</span>][i] <span style="color:#f92672">=</span> station[<span style="color:#e6db74">&#39;Thing&#39;</span>][i][<span style="color:#e6db74">&#39;properties&#39;</span>][<span style="color:#e6db74">&#39;stationName&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> pd<span style="color:#f92672">.</span>isnull(station[<span style="color:#e6db74">&#39;observedArea&#39;</span>][i]):
</span></span><span style="display:flex;"><span>            station[<span style="color:#e6db74">&#39;lat&#39;</span>][i]<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            station[<span style="color:#e6db74">&#39;observedArea&#39;</span>][i]<span style="color:#f92672">=-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            station[<span style="color:#e6db74">&#39;lat&#39;</span>][i]<span style="color:#f92672">=</span>station[<span style="color:#e6db74">&#39;lat&#39;</span>][i][<span style="color:#e6db74">&#39;coordinates&#39;</span>][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            station[<span style="color:#e6db74">&#39;observedArea&#39;</span>][i]<span style="color:#f92672">=</span>station[<span style="color:#e6db74">&#39;observedArea&#39;</span>][i][<span style="color:#e6db74">&#39;coordinates&#39;</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(station[<span style="color:#e6db74">&#39;Observations&#39;</span>][i])<span style="color:#f92672">!=</span><span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            station[<span style="color:#e6db74">&#39;Observations&#39;</span>][i] <span style="color:#f92672">=</span> station[<span style="color:#e6db74">&#39;Observations&#39;</span>][i][<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;result&#39;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            station[<span style="color:#e6db74">&#39;Observations&#39;</span>][i] <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    station <span style="color:#f92672">=</span> station<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;Thing&#34;</span>: <span style="color:#e6db74">&#34;name&#34;</span>, <span style="color:#e6db74">&#39;observedArea&#39;</span>: <span style="color:#e6db74">&#39;lon&#39;</span>})
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> num <span style="color:#f92672">==</span><span style="color:#ae81ff">0</span> :
</span></span><span style="display:flex;"><span>        water_level <span style="color:#f92672">=</span> station
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        water_level <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([water_level, station])
</span></span><span style="display:flex;"><span>    num<span style="color:#f92672">+=</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>result_df <span style="color:#f92672">=</span> water_level<span style="color:#f92672">.</span>drop_duplicates(subset<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;name&#39;</span>], keep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;first&#39;</span>)
</span></span><span style="display:flex;"><span>station<span style="color:#f92672">=</span>result_df<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;lon&#39;</span>, <span style="color:#e6db74">&#39;lat&#39;</span>])
</span></span><span style="display:flex;"><span>station<span style="color:#f92672">.</span>reset_index(inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, drop<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>station <span style="color:#f92672">=</span> station[station<span style="color:#f92672">.</span>lon<span style="color:#f92672">!=-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>gdf_level <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>GeoDataFrame(
</span></span><span style="display:flex;"><span>    station, geometry<span style="color:#f92672">=</span>gpd<span style="color:#f92672">.</span>points_from_xy(station<span style="color:#f92672">.</span>lon, station<span style="color:#f92672">.</span>lat),crs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;EPSG:4326&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># intersect with county boundary </span>
</span></span><span style="display:flex;"><span>basemap <span style="color:#f92672">=</span> county<span style="color:#f92672">.</span>loc[county[<span style="color:#e6db74">&#39;COUNTYNAME&#39;</span>]<span style="color:#f92672">.</span>isin([<span style="color:#e6db74">&#34;雲林縣&#34;</span>])]
</span></span><span style="display:flex;"><span>basemap <span style="color:#f92672">=</span> basemap<span style="color:#f92672">.</span>set_crs(<span style="color:#ae81ff">4326</span>,allow_override<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>intersected_data <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>overlay(gdf_level, basemap, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;intersection&#39;</span>) 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.cluster <span style="color:#f92672">import</span> KMeans
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.spatial <span style="color:#f92672">import</span> ConvexHull
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> folium
</span></span><span style="display:flex;"><span>clusterp <span style="color:#f92672">=</span> intersected_data[[<span style="color:#e6db74">&#34;name&#34;</span>,<span style="color:#e6db74">&#34;lon&#34;</span>, <span style="color:#e6db74">&#39;lat&#39;</span>, <span style="color:#e6db74">&#39;Observations&#39;</span>]]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. identify the clusters by kmeans</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#1.1 pre-processing</span>
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> clusterp<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>]<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ddecide the number groups by elbow method</span>
</span></span><span style="display:flex;"><span>wcss <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>):
</span></span><span style="display:flex;"><span>    kmeans <span style="color:#f92672">=</span> KMeans(n_clusters <span style="color:#f92672">=</span> i, init <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;k-means++&#39;</span>, random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>    kmeans<span style="color:#f92672">.</span>fit(X)
</span></span><span style="display:flex;"><span>    wcss<span style="color:#f92672">.</span>append(kmeans<span style="color:#f92672">.</span>inertia_)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>), wcss)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;The Elbow Method&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Number of clusters&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;WCSS&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/5-2-3-1.png" alt="Python output"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 1.2 applying K-Means model </span>
</span></span><span style="display:flex;"><span>kmeans <span style="color:#f92672">=</span> KMeans(n_clusters <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, init <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;k-means++&#39;</span>, random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>y_kmeans <span style="color:#f92672">=</span> kmeans<span style="color:#f92672">.</span>fit_predict(X)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1.3 map data back to df</span>
</span></span><span style="display:flex;"><span>clusterp[<span style="color:#e6db74">&#39;cluster&#39;</span>] <span style="color:#f92672">=</span> y_kmeans<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> <span style="color:#75715e"># to step up to group 1 to 4</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># 2. display the result on maps</span>
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> folium<span style="color:#f92672">.</span>Map(location<span style="color:#f92672">=</span>[clusterp[<span style="color:#e6db74">&#39;lat&#39;</span>]<span style="color:#f92672">.</span>mean(), clusterp[<span style="color:#e6db74">&#39;lon&#39;</span>]<span style="color:#f92672">.</span>mean()],
</span></span><span style="display:flex;"><span>               tiles<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;CartoDB positron&#39;</span>,
</span></span><span style="display:flex;"><span>               zoom_start<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create the layer by kmeans</span>
</span></span><span style="display:flex;"><span>layer1 <span style="color:#f92672">=</span> folium<span style="color:#f92672">.</span>FeatureGroup(name<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;u&gt;&lt;b&gt;group1&lt;/b&gt;&lt;/u&gt;&#39;</span>,show<span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>m<span style="color:#f92672">.</span>add_child(layer1)
</span></span><span style="display:flex;"><span>layer2 <span style="color:#f92672">=</span> folium<span style="color:#f92672">.</span>FeatureGroup(name<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;u&gt;&lt;b&gt;group2&lt;/b&gt;&lt;/u&gt;&#39;</span>,show<span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>m<span style="color:#f92672">.</span>add_child(layer2)
</span></span><span style="display:flex;"><span>layer3 <span style="color:#f92672">=</span> folium<span style="color:#f92672">.</span>FeatureGroup(name<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;u&gt;&lt;b&gt;group3&lt;/b&gt;&lt;/u&gt;&#39;</span>,show<span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>m<span style="color:#f92672">.</span>add_child(layer3)
</span></span><span style="display:flex;"><span>layer4 <span style="color:#f92672">=</span> folium<span style="color:#f92672">.</span>FeatureGroup(name<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;u&gt;&lt;b&gt;group4&lt;/b&gt;&lt;/u&gt;&#39;</span>,show<span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>m<span style="color:#f92672">.</span>add_child(layer4)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create symbology</span>
</span></span><span style="display:flex;"><span>my_symbol_css_class<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34; &lt;style&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">.fa-g1:before {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-family: Arial; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-weight: bold;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-size: 12px;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    color: black;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    background-color:white;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    border-radius: 10px; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    white-space: pre;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    content: &#39; g1 &#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">.fa-g2:before {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-family: Arial; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-weight: bold;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-size: 12px;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    color: black;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    background-color:white;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    border-radius: 10px; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    white-space: pre;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    content: &#39; g2 &#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">.fa-g3:before {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-family: Arial; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-weight: bold;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-size: 12px;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    color: black;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    background-color:white;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    border-radius: 10px; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    white-space: pre;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    content: &#39; g3 &#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">.fa-g4:before {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-family: Arial; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-weight: bold;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-size: 12px;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    color: black;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    background-color:white;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    border-radius: 10px; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    white-space: pre;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    content: &#39; g4 &#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">.fa-g1bad:before {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-family: Arial; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-weight: bold;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-size: 12px;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    color: white;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    background-color:red;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    border-radius: 10px; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    white-space: pre;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    content: &#39; g1 &#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">.fa-g2bad:before {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-family: Arial; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-weight: bold;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-size: 12px;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    color: white;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    background-color:red;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    border-radius: 10px; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    white-space: pre;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    content: &#39; g2 &#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">.fa-g3bad:before {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-family: Arial; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-weight: bold;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-size: 12px;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    color: white;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    background-color:red;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    border-radius: 10px; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    white-space: pre;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    content: &#39; g3 &#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">.fa-g4bad:before {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-family: Arial; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-weight: bold;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    font-size: 12px;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    color: white;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    background-color:red;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    border-radius: 10px; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    white-space: pre;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    content: &#39; g4 &#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;/style&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># add the symbology code to the map      </span>
</span></span><span style="display:flex;"><span>m<span style="color:#f92672">.</span>get_root()<span style="color:#f92672">.</span>html<span style="color:#f92672">.</span>add_child(folium<span style="color:#f92672">.</span>Element(my_symbol_css_class))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> index, row <span style="color:#f92672">in</span> clusterp<span style="color:#f92672">.</span>iterrows():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> row[<span style="color:#e6db74">&#39;cluster&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>
</span></span><span style="display:flex;"><span>        fa_symbol <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;fa-g1&#39;</span>
</span></span><span style="display:flex;"><span>        lay <span style="color:#f92672">=</span> layer1
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> row[<span style="color:#e6db74">&#39;cluster&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;purple&#39;</span>
</span></span><span style="display:flex;"><span>        fa_symbol <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;fa-g2&#39;</span>
</span></span><span style="display:flex;"><span>        lay <span style="color:#f92672">=</span> layer2
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> row[<span style="color:#e6db74">&#39;cluster&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>:
</span></span><span style="display:flex;"><span>        color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>
</span></span><span style="display:flex;"><span>        fa_symbol <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;fa-g3&#39;</span>
</span></span><span style="display:flex;"><span>        lay <span style="color:#f92672">=</span> layer3
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> row[<span style="color:#e6db74">&#39;cluster&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:
</span></span><span style="display:flex;"><span>        color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;blue&#39;</span>
</span></span><span style="display:flex;"><span>        fa_symbol <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;fa-g4&#39;</span>
</span></span><span style="display:flex;"><span>        lay <span style="color:#f92672">=</span> layer4
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    folium<span style="color:#f92672">.</span>Marker(
</span></span><span style="display:flex;"><span>        location<span style="color:#f92672">=</span>[row[<span style="color:#e6db74">&#39;lat&#39;</span>], row[<span style="color:#e6db74">&#39;lon&#39;</span>]],
</span></span><span style="display:flex;"><span>        title <span style="color:#f92672">=</span> row[<span style="color:#e6db74">&#39;name&#39;</span>]<span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;group:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(str(row[<span style="color:#e6db74">&#34;cluster&#34;</span>])),
</span></span><span style="display:flex;"><span>        popup <span style="color:#f92672">=</span> row[<span style="color:#e6db74">&#39;name&#39;</span>]<span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;group:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">,value:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(str(row[<span style="color:#e6db74">&#34;cluster&#34;</span>]),str(row[<span style="color:#e6db74">&#39;Observations&#39;</span>])),
</span></span><span style="display:flex;"><span>        icon<span style="color:#f92672">=</span> folium<span style="color:#f92672">.</span>Icon(color<span style="color:#f92672">=</span>color, icon<span style="color:#f92672">=</span>fa_symbol, prefix<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;fa&#39;</span>))<span style="color:#f92672">.</span>add_to(lay)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># display the result on maps</span>
</span></span><span style="display:flex;"><span>layer_list <span style="color:#f92672">=</span> [layer1,layer2,layer3,layer4]
</span></span><span style="display:flex;"><span>color_list <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;black&#39;</span>,<span style="color:#e6db74">&#39;purple&#39;</span>,<span style="color:#e6db74">&#39;orange&#39;</span>,<span style="color:#e6db74">&#39;blue&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> g <span style="color:#f92672">in</span> clusterp[<span style="color:#e6db74">&#39;cluster&#39;</span>]<span style="color:#f92672">.</span>unique():
</span></span><span style="display:flex;"><span>    latlon_cut <span style="color:#f92672">=</span>clusterp[clusterp[<span style="color:#e6db74">&#39;cluster&#39;</span>]<span style="color:#f92672">==</span>g]<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>    hull <span style="color:#f92672">=</span> ConvexHull(latlon_cut<span style="color:#f92672">.</span>values)
</span></span><span style="display:flex;"><span>    Lat <span style="color:#f92672">=</span> latlon_cut<span style="color:#f92672">.</span>values[hull<span style="color:#f92672">.</span>vertices,<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>    Long <span style="color:#f92672">=</span> latlon_cut<span style="color:#f92672">.</span>values[hull<span style="color:#f92672">.</span>vertices,<span style="color:#ae81ff">1</span>] 
</span></span><span style="display:flex;"><span>    cluster <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;lat&#39;</span>:Lat,<span style="color:#e6db74">&#39;lon&#39;</span>:Long })       
</span></span><span style="display:flex;"><span>    area <span style="color:#f92672">=</span> list(zip(cluster[<span style="color:#e6db74">&#39;lat&#39;</span>],cluster[<span style="color:#e6db74">&#39;lon&#39;</span>]))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    list_index <span style="color:#f92672">=</span> g<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> 
</span></span><span style="display:flex;"><span>    lay_cluster <span style="color:#f92672">=</span> layer_list[list_index ] 
</span></span><span style="display:flex;"><span>    folium<span style="color:#f92672">.</span>Polygon(locations<span style="color:#f92672">=</span>area,
</span></span><span style="display:flex;"><span>        color<span style="color:#f92672">=</span>color_list[list_index],
</span></span><span style="display:flex;"><span>        weight<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>        fill<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>        fill_opacity<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>,
</span></span><span style="display:flex;"><span>        opacity<span style="color:#f92672">=</span><span style="color:#ae81ff">0.8</span>)<span style="color:#f92672">.</span>add_to(lay_cluster) 
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>folium<span style="color:#f92672">.</span>LayerControl(collapsed<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>,position<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;bottomright&#39;</span>)<span style="color:#f92672">.</span>add_to(m)
</span></span><span style="display:flex;"><span>print(m)
</span></span><span style="display:flex;"><span>m<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#39;River_clustering.html&#39;</span>)
</span></span></code></pre></div><p><img src="figures/5-2-3-2.png" alt="Python output"></p>
<h2 id="kernel-density">Kernel density</h2>
<p>The concept of density allows us to describe the intensity of clustering, and it’s traditionally defined by the formula d = N/A, where d is density, N is number of observations, and A is area. However, the formula above is easily influenced by the area, which makes it possible that the same station/case numbers in towns that have different area sizes result in different densities. Therefore, we might have difficulty calculating the intensity of clustering events correctly.</p>
<p>In order to avoid calculation differences of areas, we describe the clustering intensity with the concept of kernel density, which takes observation points as centers and a fixed radius to select neighbors, and finally replaces the original observation values with the total values obtained from all neighbors. Such method standardizes the “area” in the density formula and thus obtains a more comprehensive density distribution, which helps us understand the distribution intensity of events.</p>
<p><img src="figures/5-2-4-1.png" alt="圖1：核密度推估法的概念圖"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>basemap <span style="color:#f92672">=</span> county<span style="color:#f92672">.</span>loc[county[<span style="color:#e6db74">&#39;COUNTYNAME&#39;</span>]<span style="color:#f92672">.</span>isin([<span style="color:#e6db74">&#34;嘉義縣&#34;</span>,<span style="color:#e6db74">&#34;嘉義市&#34;</span>])]
</span></span><span style="display:flex;"><span>basemap <span style="color:#f92672">=</span> basemap<span style="color:#f92672">.</span>set_crs(<span style="color:#ae81ff">4326</span>,allow_override<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>gdf <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>overlay(gdf_level, basemap, how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;intersection&#39;</span>) 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># selecting the polygon&#39;s geometry field to filter out points that </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># are not overlaid</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> plotly.express <span style="color:#66d9ef">as</span> px
</span></span><span style="display:flex;"><span>fig <span style="color:#f92672">=</span> px<span style="color:#f92672">.</span>density_mapbox(gdf, lat<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lat&#39;</span>, lon<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lon&#39;</span>, z<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Observations&#39;</span>, radius<span style="color:#f92672">=</span><span style="color:#ae81ff">25</span>,
</span></span><span style="display:flex;"><span>                        center<span style="color:#f92672">=</span>dict(lat<span style="color:#f92672">=</span><span style="color:#ae81ff">23.5</span>, lon<span style="color:#f92672">=</span><span style="color:#ae81ff">120.5</span>), zoom<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>,
</span></span><span style="display:flex;"><span>                        mapbox_style<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stamen-terrain&#34;</span>)
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/5-2-4-2.png" alt="Python output"></p>
<h2 id="spatial-interpolation">Spatial interpolation</h2>
<p>The implementation of microsensors is similar to our spatial samplings, with which we can estimate the population distribution with statistical analyses. Since it’s impossible to spread observation stations all over earth&rsquo;s surface, we are faced with conditions in which some places are rich in data while others aren’t. In such a scenario, spatial interpolation is a statistical method that helps us estimate regions without data, and to further obtain a whole picture of our study area.</p>
<p>Before conducting spatial interpolation, we need to clarify two concepts: deterministic model and stochastic model. In a deterministic model, if we know the distribution rule of certain spatial phenomena, we can estimate the value of unknown areas with correlation parameters. Take the house number in Taiwan for example. House numbers in Taiwan are arranged by odd and even numbers respectively. So, suppose we wonder the number of certain house, and we know the previous one is 6 while  the next one is 10, we can therefore presume the house in the middle (which is the one we’re interested in) is 8. As for a stochastic model, it assumes that the reality is rather complicated, and we can only construct suitable estimation models with probability and variety of variances while accepting the uncertainty.</p>
<h3 id="inverse-distance-weighting">Inverse Distance Weighting</h3>
<p>With Inverse Distance Weighting, we construct an estimation model with value deviations and intervals of known observation points. Generally speaking, if the deviation of two points is 10 and the interval is 100 meter, then the deviation per 10 meter should be 1 theoretically. But, since there may not be a linear relationship in the deviation distributions, the principle of IDW emphasizes on the first law of geography: nearby things are closer than others, and estimates value deviations of two points. By obtaining the reciprocal of the cube of the product of deviation and distance, IDW allows us to estimate values of certain positions. So, the shorter the distance is, the larger the weighting is, and vice versa.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.interpolate <span style="color:#f92672">import</span> Rbf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">distance_matrix</span>(x0, y0, x1, y1):
</span></span><span style="display:flex;"><span>    obs <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>vstack((x0, y0))<span style="color:#f92672">.</span>T
</span></span><span style="display:flex;"><span>    interp <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>vstack((x1, y1))<span style="color:#f92672">.</span>T
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># build distance matrix</span>
</span></span><span style="display:flex;"><span>    d0 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>subtract<span style="color:#f92672">.</span>outer(obs[:,<span style="color:#ae81ff">0</span>], interp[:,<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>    d1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>subtract<span style="color:#f92672">.</span>outer(obs[:,<span style="color:#ae81ff">1</span>], interp[:,<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    print(d0<span style="color:#f92672">.</span>dtype,d1<span style="color:#f92672">.</span>dtype)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>hypot(d0, d1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">simple_idw</span>(x, y, z, xi, yi, pows):
</span></span><span style="display:flex;"><span>    dist <span style="color:#f92672">=</span> distance_matrix(x,y, xi,yi)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># the IDW weight is 1 / distance</span>
</span></span><span style="display:flex;"><span>    weights <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span> <span style="color:#f92672">/</span> dist
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># weight is 1</span>
</span></span><span style="display:flex;"><span>    weights <span style="color:#f92672">/=</span> weights<span style="color:#f92672">.</span>sum(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># set the Z value</span>
</span></span><span style="display:flex;"><span>    zi <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(weights<span style="color:#f92672">.</span>T, z)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> zi
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>set_aspect(<span style="color:#e6db74">&#39;equal&#39;</span>)
</span></span><span style="display:flex;"><span>pows <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>nx, ny <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>xmin, xmax <span style="color:#f92672">=</span> <span style="color:#ae81ff">119.8</span>, <span style="color:#ae81ff">121.2</span>
</span></span><span style="display:flex;"><span>ymin, ymax <span style="color:#f92672">=</span> <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">24</span>
</span></span><span style="display:flex;"><span>interpolatep <span style="color:#f92672">=</span> gdf[[<span style="color:#e6db74">&#34;lon&#34;</span>, <span style="color:#e6db74">&#39;lat&#39;</span>, <span style="color:#e6db74">&#39;Observations&#39;</span>]]
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> interpolatep[<span style="color:#e6db74">&#39;lon&#39;</span>]
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> interpolatep[<span style="color:#e6db74">&#39;lat&#39;</span>]
</span></span><span style="display:flex;"><span>z <span style="color:#f92672">=</span> interpolatep[<span style="color:#e6db74">&#39;Observations&#39;</span>]
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;float64&#34;</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> y<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;float64&#34;</span>)
</span></span><span style="display:flex;"><span>z <span style="color:#f92672">=</span> z<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;float64&#34;</span>)
</span></span><span style="display:flex;"><span>xi <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(xmin,xmax, nx)
</span></span><span style="display:flex;"><span>yi <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(ymin, ymax, ny)
</span></span><span style="display:flex;"><span>xi, yi <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(xi, yi)
</span></span><span style="display:flex;"><span>xi, yi <span style="color:#f92672">=</span> xi<span style="color:#f92672">.</span>flatten(), yi<span style="color:#f92672">.</span>flatten()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 計算 IDW</span>
</span></span><span style="display:flex;"><span>grid <span style="color:#f92672">=</span> simple_idw(x,y,z,xi,yi,pows)
</span></span><span style="display:flex;"><span>grid <span style="color:#f92672">=</span> grid<span style="color:#f92672">.</span>reshape((ny, nx))
</span></span><span style="display:flex;"><span>grid <span style="color:#f92672">=</span> grid<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;float64&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>imshow(grid, extent<span style="color:#f92672">=</span>(xmin, xmax, ymin, ymax))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>basemap<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax, facecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;none&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lightgray&#39;</span>);
</span></span><span style="display:flex;"><span>ax<span style="color:#f92672">.</span>scatter(x, y, marker<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.&#34;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;orange&#39;</span>, s<span style="color:#f92672">=</span>z,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;input point&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>colorbar()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlim(xmin, xmax)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylim(ymin, ymax)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;IDW&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/5-2-5-1.png" alt="Python output"></p>
<h3 id="kriging">Kriging</h3>
<p>The principle of Kriging is to build a semi-variogram with the value and position of known observed points, and we can partition the observations based on the semi-variogram to obtain several regionalized variables for value estimation. Similar to IDW, Kriging also utilizes values and distances of known points to estimate nearby unknown points. Notice that in Kriging, we divide observations into groups by distances, and the estimation formulas will be adjusted according to distances.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># set the data extend and resolution</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>resolution <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.1</span>  <span style="color:#75715e"># cell size in meters</span>
</span></span><span style="display:flex;"><span>gridx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">119.8</span>, <span style="color:#ae81ff">121.2</span>, resolution)
</span></span><span style="display:flex;"><span>gridy <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">24</span>, resolution)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># set the raster to polygon </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> itertools
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> shapely.geometry <span style="color:#f92672">import</span> Polygon
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pixel2poly</span>(x, y, z, resolution):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    x: x coords of cell
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    y: y coords of cell
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    z: matrix of values for each (x,y)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    resolution: spatial resolution of each cell
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    polygons <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    values <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    half_res <span style="color:#f92672">=</span> resolution <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i, j  <span style="color:#f92672">in</span> itertools<span style="color:#f92672">.</span>product(range(len(x)), range(len(y))):
</span></span><span style="display:flex;"><span>        minx, maxx <span style="color:#f92672">=</span> x[i] <span style="color:#f92672">-</span> half_res, x[i] <span style="color:#f92672">+</span> half_res
</span></span><span style="display:flex;"><span>        miny, maxy <span style="color:#f92672">=</span> y[j] <span style="color:#f92672">-</span> half_res, y[j] <span style="color:#f92672">+</span> half_res
</span></span><span style="display:flex;"><span>        polygons<span style="color:#f92672">.</span>append(Polygon([(minx, miny), (minx, maxy), (maxx, maxy), (maxx, miny)]))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> isinstance(z, (int, float)):
</span></span><span style="display:flex;"><span>            values<span style="color:#f92672">.</span>append(z)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            values<span style="color:#f92672">.</span>append(z[j, i])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> polygons, values
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># calculate ithe pykrige package</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pykrige.ok <span style="color:#f92672">import</span> OrdinaryKriging
</span></span><span style="display:flex;"><span>krig <span style="color:#f92672">=</span> OrdinaryKriging(x<span style="color:#f92672">=</span>gdf[<span style="color:#e6db74">&#34;lon&#34;</span>], y<span style="color:#f92672">=</span>gdf[<span style="color:#e6db74">&#34;lat&#34;</span>], z<span style="color:#f92672">=</span>gdf[<span style="color:#e6db74">&#39;Observations&#39;</span>], variogram_model<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;spherical&#34;</span>, pseudo_inv<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>z, ss <span style="color:#f92672">=</span> krig<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;grid&#34;</span>, gridx, gridy)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>imshow(z);
</span></span></code></pre></div><p><img src="figures/5-2-5-2.png" alt="Python output"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># dispaly by plotly</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> plotly.express <span style="color:#66d9ef">as</span> px
</span></span><span style="display:flex;"><span>polygons, values <span style="color:#f92672">=</span> pixel2poly(gridx, gridy, z, resolution)
</span></span><span style="display:flex;"><span>water_model <span style="color:#f92672">=</span> (gpd<span style="color:#f92672">.</span>GeoDataFrame({<span style="color:#e6db74">&#34;water_modelled&#34;</span>: values}, geometry<span style="color:#f92672">=</span>polygons, crs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;EPSG:4326&#34;</span>)
</span></span><span style="display:flex;"><span>                 <span style="color:#f92672">.</span>to_crs(<span style="color:#e6db74">&#34;EPSG:4326&#34;</span>)
</span></span><span style="display:flex;"><span>                 )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fig <span style="color:#f92672">=</span> px<span style="color:#f92672">.</span>choropleth_mapbox(water_model, geojson<span style="color:#f92672">=</span>water_model<span style="color:#f92672">.</span>geometry, locations<span style="color:#f92672">=</span>water_model<span style="color:#f92672">.</span>index,
</span></span><span style="display:flex;"><span>                           color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;water_modelled&#34;</span>, color_continuous_scale<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;RdYlGn_r&#34;</span>, opacity<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>,
</span></span><span style="display:flex;"><span>                           center<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;lat&#34;</span>: <span style="color:#ae81ff">24</span>, <span style="color:#e6db74">&#34;lon&#34;</span>: <span style="color:#ae81ff">121</span>}, zoom<span style="color:#f92672">=</span><span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>                           mapbox_style<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;carto-positron&#34;</span>)
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>update_layout(margin<span style="color:#f92672">=</span>dict(l<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, r<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, t<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>, b<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>fig<span style="color:#f92672">.</span>update_traces(marker_line_width<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span></code></pre></div><p><img src="figures/5-2-5-3.png" alt="Python output"></p>
<h3 id="nearest-neighbor-interpolation">Nearest neighbor Interpolation</h3>
<p>Nearest Neighbor Interpolation is actually quite simple. If we want to know the value of a certain position, we only need to find the nearest station with data, thus taking it in replacement. The design of this method basically follows the principle of “nearby things are more similar,” and it’s often applied in image processing and cases of enlargement.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> scipy.interpolate <span style="color:#f92672">import</span> NearestNDInterpolator
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>interpolatep <span style="color:#f92672">=</span> gdf[[<span style="color:#e6db74">&#34;lon&#34;</span>, <span style="color:#e6db74">&#39;lat&#39;</span>, <span style="color:#e6db74">&#39;Observations&#39;</span>]]
</span></span><span style="display:flex;"><span>xd <span style="color:#f92672">=</span> interpolatep[<span style="color:#e6db74">&#39;lon&#39;</span>]
</span></span><span style="display:flex;"><span>yd <span style="color:#f92672">=</span> interpolatep[<span style="color:#e6db74">&#39;lat&#39;</span>]
</span></span><span style="display:flex;"><span>zd <span style="color:#f92672">=</span> interpolatep[<span style="color:#e6db74">&#39;Observations&#39;</span>]
</span></span><span style="display:flex;"><span>xd <span style="color:#f92672">=</span> xd<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;float64&#34;</span>)
</span></span><span style="display:flex;"><span>yd <span style="color:#f92672">=</span> yd<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;float64&#34;</span>)
</span></span><span style="display:flex;"><span>zd <span style="color:#f92672">=</span> zd<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;float64&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(min(xd), max(xd))
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(min(yd), max(yd))
</span></span><span style="display:flex;"><span>X, Y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(X, Y)  <span style="color:#75715e"># 2D grid for interpolation</span>
</span></span><span style="display:flex;"><span>interp <span style="color:#f92672">=</span> NearestNDInterpolator(list(zip(xd, yd)), zd)
</span></span><span style="display:flex;"><span>Z <span style="color:#f92672">=</span> interp(X, Y)
</span></span><span style="display:flex;"><span>im <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>pcolormesh(X, Y, Z, shading<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;auto&#39;</span>)
</span></span><span style="display:flex;"><span>basemap<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax, facecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;none&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>);
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>scatterplot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lon&#39;</span>, y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lat&#39;</span>, data<span style="color:#f92672">=</span>interpolatep,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;input point&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>colorbar(im)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlim(xmin, xmax)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylim(ymin, ymax)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/5-2-5-4.png" alt="Python output"></p>
<h2 id="contour">Contour</h2>
<p>Generally speaking, after conducting spatial interpolation to the position and values of stations, we will obtain comprehensive grid data. How can we analyze the grid data? First, the easiest method is to draw a line connecting nearby points by the values and positions of the grid, which is similar to drawing contours on changing landforms, so that we can consider values on the same line as equivalent.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> osgeo <span style="color:#f92672">import</span> gdal
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib 
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> elevation 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 利用 Matplotlib 中的 &#39;contourf&#39; 函式來畫</span>
</span></span><span style="display:flex;"><span>fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(xmin, xmax)
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(ymin, ymax)
</span></span><span style="display:flex;"><span>krig <span style="color:#f92672">=</span> OrdinaryKriging(x<span style="color:#f92672">=</span>interpolatep[<span style="color:#e6db74">&#39;lon&#39;</span>], y<span style="color:#f92672">=</span>interpolatep[<span style="color:#e6db74">&#39;lat&#39;</span>], z<span style="color:#f92672">=</span>interpolatep[<span style="color:#e6db74">&#39;Observations&#39;</span>], variogram_model<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;spherical&#34;</span>)
</span></span><span style="display:flex;"><span>z, ss <span style="color:#f92672">=</span> krig<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;grid&#34;</span>, X, Y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>im <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>contourf(z, cmap <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;viridis&#34;</span>, 
</span></span><span style="display:flex;"><span>            levels <span style="color:#f92672">=</span> list(range(<span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">10</span>)),extent<span style="color:#f92672">=</span>(xmin, xmax, ymin, ymax))
</span></span><span style="display:flex;"><span>basemap<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax, facecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;none&#39;</span>, edgecolor<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;black&#39;</span>);
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Elevation Contours Taiwan&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/5-2-6-1.png" alt="Python output"></p>
<h3 id="profile">Profile</h3>
<p>Contours help us attain value distribution and ranges, and geographical profiling is another method for understanding value distribution. By drawing a straight line between two points, geographical profiling helps us to retrieve corresponding values according to positions of lines for estimation. This method allows us to inspect value variation between two points. In some studies of air quality, scientists evaluate changes of PM2.5 on both sides of roads with geographical profiling.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">export_kde_raster</span>(Z, XX, YY, min_x, max_x, min_y, max_y, proj, filename):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;&#39;&#39;Export and save a kernel density raster.&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 取得解析度</span>
</span></span><span style="display:flex;"><span>    xres <span style="color:#f92672">=</span> (max_x <span style="color:#f92672">-</span> min_x) <span style="color:#f92672">/</span> len(XX)
</span></span><span style="display:flex;"><span>    yres <span style="color:#f92672">=</span> (max_y <span style="color:#f92672">-</span> min_y) <span style="color:#f92672">/</span> len(YY)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 取得 bound 等資訊</span>
</span></span><span style="display:flex;"><span>    transform <span style="color:#f92672">=</span> Affine<span style="color:#f92672">.</span>translation(min_x <span style="color:#f92672">-</span> xres <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>, min_y <span style="color:#f92672">-</span> yres <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">*</span> Affine<span style="color:#f92672">.</span>scale(xres, yres)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 輸出為 raster</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> rasterio<span style="color:#f92672">.</span>open(
</span></span><span style="display:flex;"><span>            filename,
</span></span><span style="display:flex;"><span>            mode <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;w&#34;</span>,
</span></span><span style="display:flex;"><span>            driver <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;GTiff&#34;</span>,
</span></span><span style="display:flex;"><span>            height <span style="color:#f92672">=</span> Z<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>],
</span></span><span style="display:flex;"><span>            width <span style="color:#f92672">=</span> Z<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>],
</span></span><span style="display:flex;"><span>            count <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>            dtype <span style="color:#f92672">=</span> Z<span style="color:#f92672">.</span>dtype,
</span></span><span style="display:flex;"><span>            crs <span style="color:#f92672">=</span> proj,
</span></span><span style="display:flex;"><span>            transform <span style="color:#f92672">=</span> transform,
</span></span><span style="display:flex;"><span>    ) <span style="color:#66d9ef">as</span> new_dataset:
</span></span><span style="display:flex;"><span>            new_dataset<span style="color:#f92672">.</span>write(Z, <span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pykrige.ok <span style="color:#f92672">import</span> OrdinaryKriging
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> affine <span style="color:#f92672">import</span> Affine
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> rasterio
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> math
</span></span><span style="display:flex;"><span>start_cor <span style="color:#f92672">=</span> [<span style="color:#ae81ff">119.9</span>,<span style="color:#ae81ff">23.2</span>]
</span></span><span style="display:flex;"><span>end_cor <span style="color:#f92672">=</span> [<span style="color:#ae81ff">120.1</span>,<span style="color:#ae81ff">23.9</span>]
</span></span><span style="display:flex;"><span>npoints<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(xmin, xmax, npoints)
</span></span><span style="display:flex;"><span>Y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(ymin, ymax, npoints)
</span></span><span style="display:flex;"><span>interpolatep <span style="color:#f92672">=</span> gdf[[<span style="color:#e6db74">&#34;lon&#34;</span>, <span style="color:#e6db74">&#39;lat&#39;</span>, <span style="color:#e6db74">&#39;Observations&#39;</span>]]
</span></span><span style="display:flex;"><span>xd <span style="color:#f92672">=</span> interpolatep[<span style="color:#e6db74">&#39;lon&#39;</span>]
</span></span><span style="display:flex;"><span>yd <span style="color:#f92672">=</span> interpolatep[<span style="color:#e6db74">&#39;lat&#39;</span>]
</span></span><span style="display:flex;"><span>zd <span style="color:#f92672">=</span> interpolatep[<span style="color:#e6db74">&#39;Observations&#39;</span>]
</span></span><span style="display:flex;"><span>xd <span style="color:#f92672">=</span> xd<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;float64&#34;</span>)
</span></span><span style="display:flex;"><span>yd <span style="color:#f92672">=</span> yd<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;float64&#34;</span>)
</span></span><span style="display:flex;"><span>zd <span style="color:#f92672">=</span> zd<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#34;float64&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>krig <span style="color:#f92672">=</span> OrdinaryKriging(x<span style="color:#f92672">=</span>xd, y<span style="color:#f92672">=</span>yd, z<span style="color:#f92672">=</span>zd, variogram_model<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;spherical&#34;</span>)
</span></span><span style="display:flex;"><span>zr, ss <span style="color:#f92672">=</span> krig<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;grid&#34;</span>, X, Y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 輸出 raster</span>
</span></span><span style="display:flex;"><span>export_kde_raster(Z <span style="color:#f92672">=</span> zr, XX <span style="color:#f92672">=</span> X, YY <span style="color:#f92672">=</span> Y,
</span></span><span style="display:flex;"><span>                  min_x <span style="color:#f92672">=</span> xmin, max_x <span style="color:#f92672">=</span> xmax, min_y <span style="color:#f92672">=</span> ymin, max_y <span style="color:#f92672">=</span> ymax,
</span></span><span style="display:flex;"><span>                  proj <span style="color:#f92672">=</span> <span style="color:#ae81ff">4326</span>, filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;kriging_result.tif&#34;</span>)
</span></span><span style="display:flex;"><span>kriging <span style="color:#f92672">=</span> rasterio<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#34;kriging_result.tif&#34;</span>,mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dist <span style="color:#f92672">=</span> math<span style="color:#f92672">.</span>sqrt((end_cor[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-</span>start_cor[<span style="color:#ae81ff">0</span>])<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span><span style="color:#f92672">+</span>(end_cor[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>start_cor[<span style="color:#ae81ff">1</span>])<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span><span style="color:#ae81ff">111</span>
</span></span><span style="display:flex;"><span>npoints<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>
</span></span><span style="display:flex;"><span>lat <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(start_cor[<span style="color:#ae81ff">1</span>], end_cor[<span style="color:#ae81ff">1</span>],npoints)
</span></span><span style="display:flex;"><span>lon <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(start_cor[<span style="color:#ae81ff">0</span>], end_cor[<span style="color:#ae81ff">0</span>],npoints)
</span></span><span style="display:flex;"><span>distarray <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, dist,npoints)
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>append(distarray, dist)
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({<span style="color:#e6db74">&#39;Latitude&#39;</span>: lat, <span style="color:#e6db74">&#39;Longtitude&#39;</span>:lon,<span style="color:#e6db74">&#39;h_distance&#39;</span>:distarray})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df[<span style="color:#e6db74">&#39;Observations&#39;</span>]<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>gdf_pcs <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>GeoDataFrame(df, geometry <span style="color:#f92672">=</span> gpd<span style="color:#f92672">.</span>points_from_xy(df<span style="color:#f92672">.</span>Longtitude, df<span style="color:#f92672">.</span>Latitude))
</span></span><span style="display:flex;"><span>gdf_pcs<span style="color:#f92672">.</span>crs <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;init&#39;</span>:<span style="color:#e6db74">&#39;epsg:4326&#39;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> index, row <span style="color:#f92672">in</span> gdf_pcs<span style="color:#f92672">.</span>iterrows():
</span></span><span style="display:flex;"><span>    rows, cols <span style="color:#f92672">=</span> kriging<span style="color:#f92672">.</span>index(row[<span style="color:#e6db74">&#39;geometry&#39;</span>]<span style="color:#f92672">.</span>x,row[<span style="color:#e6db74">&#39;geometry&#39;</span>]<span style="color:#f92672">.</span>y)
</span></span><span style="display:flex;"><span>    kri_data <span style="color:#f92672">=</span> kriging<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">1</span>)    
</span></span><span style="display:flex;"><span>    df[<span style="color:#e6db74">&#39;Observations&#39;</span>]<span style="color:#f92672">.</span>loc[index] <span style="color:#f92672">=</span> kri_data[rows, cols]
</span></span><span style="display:flex;"><span>profile <span style="color:#f92672">=</span> df[[<span style="color:#e6db74">&#39;h_distance&#39;</span>,<span style="color:#e6db74">&#39;Observations&#39;</span>]]
</span></span><span style="display:flex;"><span>profile<span style="color:#f92672">.</span>plot(x<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;h_distance&#39;</span>,y<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Observations&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>kriging<span style="color:#f92672">.</span>close()
</span></span></code></pre></div><p><img src="figures/5-2-6-2.png" alt="Python output"></p>
<h2 id="references">References</h2>
<ul>
<li>Geopandas <a href="https://ithelp.ithome.com.tw/articles/10202336">https://ithelp.ithome.com.tw/articles/10202336</a></li>
<li>scipy.spatial  (<a href="https://docs.scipy.org/doc/scipy/reference/spatial.html">https://docs.scipy.org/doc/scipy/reference/spatial.html</a>)</li>
<li>scipy.interpolate  (<a href="https://docs.scipy.org/doc/scipy/reference/interpolate.html">https://docs.scipy.org/doc/scipy/reference/interpolate.html</a>)</li>
<li>pykrige  (<a href="https://geostat-framework.readthedocs.io/projects/pykrige/en/stable/api.html#krigging-algorithms">https://geostat-framework.readthedocs.io/projects/pykrige/en/stable/api.html#krigging-algorithms</a>)</li>
</ul>

            <footer class="footline">
            </footer>
          </article>


<div align="center">
<hr width="70%">

This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported License</a>.
<br />
<a rel="license" href="http://creativecommons.org/licenses/by/3.0/"><img alt="Creative Commons License" style="border-width:0;margin:2px" src="https://i.creativecommons.org/l/by/3.0/88x31.png" /></a>
</div>
<p style="height:30px">

<div id="disqus_thread" style="border-style: ridge; padding-inline:5px"></div>
<script type="text/javascript">

(function() {
    
    
    
    

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'learnciot';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        </div>
      </main>
    </div>
    <aside id="sidebar" class="default-animation showVisitedLinks">
      <div id="header-wrapper" class="default-animation">
        <div id="header" class="default-animation">
          <style>
            #logo svg,
            #logo svg * {
              color: #282828;
              color: var(--MENU-SECTIONS-BG-color);
              fill: #282828 !important;
              fill: var(--MENU-SECTIONS-BG-color) !important;
              opacity: .945;
            }
            a#logo {
              color: #282828;
              color: var(--MENU-SECTIONS-BG-color);
              font-family: 'Work Sans', 'Helvetica', 'Tahoma', 'Geneva', 'Arial', sans-serif;
              font-size: 30px;
              font-weight: 300;
              margin-top: -13px;
              max-width: 60%;
              text-transform: uppercase;
              width: 226px;
              white-space: nowrap;
            }
            a#logo:hover {
              color: #282828;
              color: var(--MENU-SECTIONS-BG-color);
            }
            #logo svg {
              margin-bottom: -20px;
              margin-left: -23.5px;
              width: 40.5%;
            }
            @media only all and (max-width: 59.938em) {
              a#logo {
                font-size: 25px;
                margin-top: -3px;
              }
              #logo svg {
                margin-bottom: -12px;
                margin-left: -23px;
              }
            }
            @media all and (-ms-high-contrast:none) {
              /* IE11s understanding of positioning is weird at best */
              a#logo {
                margin-top: -58px;
              }
              #logo svg {
                margin-bottom: -62px;
              }
            }
          </style>
          <a id="logo" href="/en/">
            Learn CIoT
          </a>

        </div>
        <div class="searchbox default-animation">
          <label class="a11y-only" for="search-by">Search</label>
          <i class="fas fa-search"></i>
          <input data-search-input id="search-by" type="search" placeholder="Search...">
          <span data-search-clear=""><i class="fas fa-times"></i></span>
        </div>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1700097412" defer></script>
        <script src="/js/lunr.min.js?1700097412" defer></script>
        <script src="/js/lunr.stemmer.support.min.js?1700097412" defer></script>
        <script src="/js/lunr.multi.min.js?1700097412" defer></script>
        <script src="/js/lunr.en.min.js?1700097412" defer></script>
        <script src="/js/search.js?1700097412" defer></script>
      </div>
      <div id="content-wrapper" class="highlightable">
        <ul class="topics">
          <li data-nav-id="/en/ch1/" title="1. Introduction" class="dd-item"><a href="/en/ch1/">1. Introduction<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch2/" title="2. Overview of the Materials" class="dd-item"><label for="section-8824f0908e4fd15c767980c76e6fd82a" ></label><a href="/en/ch2/">2. Overview of the Materials<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch2/ch2.1/" title="2.1. Material Architecture" class="dd-item"><a href="/en/ch2/ch2.1/">2.1. Material Architecture<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch2/ch2.2/" title="2.2. Material Tools" class="dd-item"><a href="/en/ch2/ch2.2/">2.2. Material Tools<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/ch3/" title="3. Data Access" class="dd-item"><label for="section-8b3bcaa38467a39b2570f38fd8603d10" ></label><a href="/en/ch3/">3. Data Access<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch3/ch3.1/" title="3.1. Basic Data Access Methods" class="dd-item"><a href="/en/ch3/ch3.1/">3.1. Basic Data Access Methods<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch3/ch3.2/" title="3.2. Data Access under Spatial or Temporal Conditions" class="dd-item"><a href="/en/ch3/ch3.2/">3.2. Data Access under Spatial or Temporal Conditions<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/ch4/" title="4. Time Series Data Analysis" class="dd-item"><label for="section-b911da0d9c15f301a7d3deea0e716021" ></label><a href="/en/ch4/">4. Time Series Data Analysis<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch4/ch4.1/" title="4.1. Time Series Data Processing" class="dd-item"><a href="/en/ch4/ch4.1/">4.1. Time Series Data Processing<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch4/ch4.2/" title="4.2. Time Series Data Forecast" class="dd-item"><a href="/en/ch4/ch4.2/">4.2. Time Series Data Forecast<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch4/ch4.3/" title="4.3. Time Series Data Clustering" class="dd-item"><a href="/en/ch4/ch4.3/">4.3. Time Series Data Clustering<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/ch5/" title="5. Spatial Data Analysis" class="dd-item parent"><label for="section-adab050366c685297e1eadc5faf1472e" ></label><a href="/en/ch5/">5. Spatial Data Analysis<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch5/ch5.1/" title="5.1. Geospatial Filtering" class="dd-item"><a href="/en/ch5/ch5.1/">5.1. Geospatial Filtering<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch5/ch5.2/" title="5.2. Geospatial Analysis" class="dd-item active"><a href="/en/ch5/ch5.2/">5.2. Geospatial Analysis<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/ch6/" title="6. Data Applications" class="dd-item"><label for="section-4be7f7872a5d83dfd50bf0f4ff5c2761" ></label><a href="/en/ch6/">6. Data Applications<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch6/ch6.1/" title="6.1. Machine Learning Preliminaries" class="dd-item"><a href="/en/ch6/ch6.1/">6.1. Machine Learning Preliminaries<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch6/ch6.2/" title="6.2. Anomaly Detection" class="dd-item"><a href="/en/ch6/ch6.2/">6.2. Anomaly Detection<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch6/ch6.3/" title="6.3. Joint Data Calibration" class="dd-item"><a href="/en/ch6/ch6.3/">6.3. Joint Data Calibration<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/ch7/" title="7. System Applications" class="dd-item"><label for="section-af7207ef140cc843a4d69557766c672f" ></label><a href="/en/ch7/">7. System Applications<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch7/ch7.1/" title="7.1. QGIS Application" class="dd-item"><a href="/en/ch7/ch7.1/">7.1. QGIS Application<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch7/ch7.2/" title="7.2. Tableau Application" class="dd-item"><a href="/en/ch7/ch7.2/">7.2. Tableau Application<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch7/ch7.3/" title="7.3. Leafmap Applications" class="dd-item"><a href="/en/ch7/ch7.3/">7.3. Leafmap Applications<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/about/" title="About" class="dd-item"><a href="/en/about/">About<i class="fas fa-check read-icon"></i></a></li>
        </ul>
        <div id="shortcuts">
          <div class="nav-title">More</div>
          <ul>
            <li><a class="padding" href="https://github.com/LearnCIOT/LearnCIOT.github.io"><i class='fab fa-fw fa-github'></i> GitHub repo</a></li>
            <li><a class="padding" href="/en/levels/"><i class='fas fa-fw fa-heartbeat'></i> Search by difficulty</a></li>
            <li><a class="padding" href="/en/tags/"><i class='fas fa-fw fa-tags'></i> Search by topics</a></li>
            <li><a class="padding" href="/en/authors/"><i class='fas fa-fw fa-users'></i> Search by authors</a></li>
          </ul>
        </div>
        <div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showLangSwitch showVisitedLinks showFooter"></div>
        <hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showLangSwitch showVisitedLinks showFooter"/>
        <div id="prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks showLangSwitch showVisitedLinks">
          <ul>
            <li id="select-language-container" class="footerLangSwitch showLangSwitch">
              <a class="padding select-container">
                <i class="fas fa-language fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <select id="select-language" onchange="location = baseUri + this.value;">
                    <option id="en" value="/en/ch5/ch5.2/" selected>English</option>
                    <option id="zh-tw" value="/ch5/ch5.2/">中文</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </a>
            </li>
            <li id="select-variant-container" class="footerVariantSwitch">
              <a class="padding select-container">
                <i class="fas fa-paint-brush fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <select id="select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                    <option id="relearn-light" value="relearn-light" selected>Relearn Light</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </a>
              <script>window.variants && variants.markSelectedVariant();</script>
            </li>
            <li class="footerVisitedLinks showVisitedLinks"><a class="padding" onclick="clearHistory();"><i class="fas fa-history fa-fw"></i> Clear History</a></li>
          </ul>
        </div>
        <div id="footer" class="footerFooter showFooter">
	    <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
        </div>
      </div>
    </aside>

    <script src="/js/clipboard.min.js?1700097412" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1700097412" defer></script>
    <script src="/js/featherlight.min.js?1700097412" defer></script>
    <script src="/js/jquery.svg.pan.zoom.js?1700097412" defer></script>
    <script src="/js/mermaid.min.js?1700097412" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/js/theme.js?1700097412" defer></script>
  </body>
</html>
