<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.104.3">
    <meta name="generator" content="Relearn 5.3.3+tip">
    <meta name="description" content="We use the sensing data of Civil IoT Taiwan Data Service Platform to guide readers to understand the use of moving average, perform periodic analysis of time series data, and then disassemble the time series data into long-term trends, seasonal changes and residual fluctuations. At the same time, we apply the existing Python language suites to perform change point detection and outlier detection to check the existing Civil IoT Taiwan data, and discuss potential implications of such values detected.">
    <meta name="author" content="Ling-Jyh Chen">
    <title>4.1. Time Series Data Processing :: Tutorial for CIoT Open Data Applications</title>
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="/css/fontawesome-all.min.css?1667519924" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1667519924" rel="stylesheet"></noscript>
    <link href="/css/featherlight.min.css?1667519924" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/featherlight.min.css?1667519924" rel="stylesheet"></noscript>
    <link href="/css/auto-complete.css?1667519924" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1667519924" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1667519924" rel="stylesheet">
    <link href="/css/nucleus.css?1667519924" rel="stylesheet">
    <link href="/css/fonts.css?1667519924" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1667519924" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1667519924" rel="stylesheet">
    <link href="/css/theme-relearn-light.css?1667519924" rel="stylesheet" id="variant-style">
    <link href="/css/ie.css?1667519924" rel="stylesheet">
    <link href="/css/variant.css?1667519924" rel="stylesheet">
    <link href="/css/print.css?1667519924" rel="stylesheet" media="print">
    <script src="/js/variant.js?1667519924"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      var index_url="/en/index.json";
      var root_url="/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      // some further base stuff
      var baseUriFull='https:\/\/LearnCIOT.github.io/';
      window.variants && variants.init( [ 'relearn-light' ] );
    </script>
    <script src="/js/jquery.min.js?1667519924" defer></script>
<meta property="fb:app_id" content="601826851395774" />
  </head>
  <body class="default-animation" data-url="/en/ch4/ch4.1/">

<div class="box">
    <div class="ribbon"><span>Beta</span></div>
</div>

<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v14.0" nonce="hWjBXHAv"></script>

    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable">
        <div>
          <div class="navigation">
             <a class="nav nav-next" href="/en/ch5/" title="5. Spatial Data Analysis"><i class="fas fa-chevron-right fa-fw"></i></a>
          </div>
          <div class="navigation">
             <a class="nav nav-prev" href="/en/ch4/" title="4. Time Series Data Analysis"><i class="fas fa-chevron-left fa-fw"></i></a>
          </div>
          <div id="top-github-link">
            <a class="github-link" title='Edit' href="https://github.com/LearnCIOT/LearnCIOT.github.io/tree/main/content/ch4/ch4.1/index.en.md" target="blank">
              <i class="fas fa-pen fa-fw"></i>
            </a>
          </div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menu'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <span id="toc-menu" title='Table of Contents'><i class="fas fa-list-alt fa-fw"></i></span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <meta itemprop="itemListOrder" content="Descending" />
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="3" /><a itemprop="item" href="/en/"><span itemprop="name">Learning Civil IoT Taiwan Open Data and Its Applications</span></a> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="2" /><a itemprop="item" href="/en/ch4/"><span itemprop="name">4. Time Series Data Analysis</span></a> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><meta itemprop="position" content="1" /><a itemprop="item" href="/en/ch4/ch4.1/" aria-disabled="true"><span itemprop="name">4.1. Time Series Data Processing</span></a></li>
            </ol>
          </div>
          <div class="default-animation progress">
            <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#goal">Goal</a></li>
    <li><a href="#package-installation-and-importing">Package Installation and Importing</a></li>
    <li><a href="#data-access">Data Access</a>
      <ul>
        <li><a href="#air-quality-data">Air Quality Data</a></li>
        <li><a href="#water-level-data">Water Level Data</a></li>
        <li><a href="#meteorological-data">Meteorological Data</a></li>
      </ul>
    </li>
    <li><a href="#data-visualization">Data Visualization</a>
      <ul>
        <li><a href="#data-resample">Data Resample</a></li>
        <li><a href="#moving-average">Moving Average</a></li>
        <li><a href="#multi-line-charts">Multi-line Charts</a></li>
        <li><a href="#calendar-heatmap">Calendar Heatmap</a></li>
      </ul>
    </li>
    <li><a href="#data-quality-inspection">Data Quality Inspection</a>
      <ul>
        <li><a href="#outlier-detection">Outlier Detection</a></li>
        <li><a href="#change-point-detection">Change Point Detection)</a></li>
        <li><a href="#missing-data-handling">Missing Data Handling</a></li>
      </ul>
    </li>
    <li><a href="#data-decomposition">Data Decomposition</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
            </div>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable ">
        <div class="flex-block-wrapper">
          <div id="head-tags"><div class="tags">
  <a class="level-link" href="/en/levels/beginner">
  <b>
	&starf;&star;&star;&star;&star;
  </b>
  </a>
  <a class="tag-link" href="/en/tags/air">Air</a>
  <a class="tag-link" href="/en/tags/python">Python</a>
  <a class="tag-link" href="/en/tags/water">Water</a>
</div>

          </div>


  
  
  

  <section class="social-share">
    <ul class="share-icons">
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?hashtags=codingnconcepts&amp;url=https%3a%2f%2fLearnCIOT.github.io%2fen%2fch4%2fch4.1%2f&amp;text=4.1.%20Time%20Series%20Data%20Processing" target="_blank" rel="noopener" aria-label="Share on Twitter" class="share-btn twitter">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="26px" viewBox="0 0 31 26" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(11.372549%,60.784314%,94.117647%);fill-opacity:1;" d="M 27.742188 6.535156 C 27.761719 6.8125 27.761719 7.089844 27.761719 7.371094 C 27.761719 15.875 21.414062 25.683594 9.800781 25.683594 L 9.800781 25.675781 C 6.371094 25.683594 3.011719 24.679688 0.125 22.792969 C 0.625 22.851562 1.125 22.882812 1.628906 22.886719 C 4.46875 22.886719 7.230469 21.914062 9.46875 20.125 C 6.765625 20.070312 4.398438 18.277344 3.570312 15.65625 C 4.515625 15.839844 5.492188 15.800781 6.421875 15.542969 C 3.476562 14.9375 1.355469 12.300781 1.355469 9.234375 L 1.355469 9.152344 C 2.234375 9.652344 3.214844 9.929688 4.222656 9.960938 C 1.449219 8.070312 0.59375 4.304688 2.265625 1.363281 C 5.472656 5.386719 10.203125 7.832031 15.277344 8.089844 C 14.769531 5.855469 15.464844 3.511719 17.105469 1.941406 C 19.644531 -0.496094 23.644531 -0.371094 26.035156 2.21875 C 27.449219 1.933594 28.804688 1.40625 30.042969 0.65625 C 29.574219 2.144531 28.585938 3.410156 27.269531 4.214844 C 28.519531 4.066406 29.742188 3.722656 30.894531 3.203125 C 30.046875 4.496094 28.980469 5.625 27.742188 6.535156 Z M 27.742188 6.535156 "/>
</g>
</svg>

          <p>Twitter</p>
          </a>
      </li>
      

      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fLearnCIOT.github.io%2fen%2fch4%2fch4.1%2f" target="_blank" rel="noopener" aria-label="Share on Facebook" class="share-btn facebook">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="32px" viewBox="0 0 32 32" version="1.1">
<defs>
<linearGradient id="linear0" gradientUnits="userSpaceOnUse" x1="-277.375" y1="406.6018" x2="-277.375" y2="407.5726" gradientTransform="matrix(32,0,0,-31.82224,8892.0008,12969.8672)">
<stop offset="0" style="stop-color:rgb(0%,38.431373%,87.843137%);stop-opacity:1;"/>
<stop offset="1" style="stop-color:rgb(9.803922%,68.627451%,100%);stop-opacity:1;"/>
</linearGradient>
</defs>
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:url(#linear0);" d="M 13.359375 31.839844 C 5.761719 30.480469 0 23.921875 0 16 C 0 7.199219 7.199219 0 16 0 C 24.800781 0 32 7.199219 32 16 C 32 23.921875 26.238281 30.480469 18.640625 31.839844 L 17.761719 31.121094 L 14.238281 31.121094 Z M 13.359375 31.839844 "/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 22.238281 20.480469 L 22.960938 16 L 18.71875 16 L 18.71875 12.878906 C 18.71875 11.601562 19.199219 10.640625 21.121094 10.640625 L 23.199219 10.640625 L 23.199219 6.558594 C 22.078125 6.398438 20.800781 6.238281 19.679688 6.238281 C 16 6.238281 13.441406 8.480469 13.441406 12.480469 L 13.441406 16 L 9.441406 16 L 9.441406 20.480469 L 13.441406 20.480469 L 13.441406 31.761719 C 14.320312 31.921875 15.199219 32 16.078125 32 C 16.960938 32 17.839844 31.921875 18.71875 31.761719 L 18.71875 20.480469 Z M 22.238281 20.480469 "/>
</g>
</svg>

          <p>Facebook</p>
          </a>
      </li>
      

      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fLearnCIOT.github.io%2fen%2fch4%2fch4.1%2f&amp;source=https%3a%2f%2fLearnCIOT.github.io%2fen%2fch4%2fch4.1%2f&amp;title=4.1.%20Time%20Series%20Data%20Processing&amp;summary=4.1.%20Time%20Series%20Data%20Processing" target="_blank" rel="noopener" aria-label="Share on LinkedIn" class="share-btn linkedin">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="32px" viewBox="0 0 32 32" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:evenodd;fill:rgb(0%,49.411765%,73.333333%);fill-opacity:1;" d="M 16 32 C 24.835938 32 32 24.835938 32 16 C 32 7.164062 24.835938 0 16 0 C 7.164062 0 0 7.164062 0 16 C 0 24.835938 7.164062 32 16 32 Z M 16 32 "/>
<path style=" stroke:none;fill-rule:evenodd;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 26.222656 25.332031 L 22.203125 25.332031 L 22.203125 18.488281 C 22.203125 16.613281 21.492188 15.566406 20.007812 15.566406 C 18.390625 15.566406 17.546875 16.65625 17.546875 18.488281 L 17.546875 25.332031 L 13.675781 25.332031 L 13.675781 12.296875 L 17.546875 12.296875 L 17.546875 14.050781 C 17.546875 14.050781 18.710938 11.898438 21.476562 11.898438 C 24.242188 11.898438 26.222656 13.585938 26.222656 17.078125 Z M 9.054688 10.589844 C 7.734375 10.589844 6.667969 9.511719 6.667969 8.183594 C 6.667969 6.855469 7.734375 5.777344 9.054688 5.777344 C 10.375 5.777344 11.441406 6.855469 11.441406 8.183594 C 11.441406 9.511719 10.375 10.589844 9.054688 10.589844 Z M 7.054688 25.332031 L 11.09375 25.332031 L 11.09375 12.296875 L 7.054688 12.296875 Z M 7.054688 25.332031 "/>
</g>
</svg>

            <p>LinkedIn</p>
          </a>
      </li>
      

      
      
      <li>
        <a href="whatsapp://send?text=4.1.%20Time%20Series%20Data%20Processing%2c%20by%20Tutorial%20for%20CIoT%20Open%20Data%20Applications%0aWe%20use%20the%20sensing%20data%20of%20Civil%20IoT%20Taiwan%20Data%20Service%20Platform%20to%20guide%20readers%20to%20understand%20the%20use%20of%20moving%20average%2c%20perform%20periodic%20analysis%20of%20time%20series%20data%2c%20and%20then%20disassemble%20the%20time%20series%20data%20into%20long-term%20trends%2c%20seasonal%20changes%20and%20residual%20fluctuations.%20At%20the%20same%20time%2c%20we%20apply%20the%20existing%20Python%20language%20suites%20to%20perform%20change%20point%20detection%20and%20outlier%20detection%20to%20check%20the%20existing%20Civil%20IoT%20Taiwan%20data%2c%20and%20discuss%20potential%20implications%20of%20such%20values%20detected.%0a%0ahttps%3a%2f%2fLearnCIOT.github.io%2fen%2fch4%2fch4.1%2f%0a" target="_blank" class="share-btn whatsapp">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="32px" viewBox="0 0 32 32" version="1.1">
<defs>
<image id="image5" width="588" height="590" xlink:href="data:image/png;base64,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"/>
</defs>
<g id="surface2">
<use xlink:href="#image5" transform="matrix(0.054145,0,0,0.054145,0.054145,0)"/>
<path style=" stroke:none;fill-rule:evenodd;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 24.355469 7.726562 C 22.222656 5.585938 19.378906 4.410156 16.355469 4.40625 C 10.117188 4.40625 5.042969 9.484375 5.042969 15.71875 C 5.039062 17.714844 5.5625 19.660156 6.550781 21.375 L 4.945312 27.238281 L 10.945312 25.664062 C 12.597656 26.566406 14.457031 27.039062 16.351562 27.042969 L 16.355469 27.042969 C 22.589844 27.042969 27.664062 21.964844 27.667969 15.730469 C 27.667969 12.707031 26.492188 9.863281 24.355469 7.726562 Z M 16.355469 25.132812 L 16.351562 25.132812 C 14.664062 25.128906 13.007812 24.675781 11.566406 23.820312 L 11.222656 23.617188 L 7.664062 24.550781 L 8.613281 21.082031 L 8.390625 20.722656 C 7.449219 19.226562 6.949219 17.496094 6.953125 15.71875 C 6.953125 10.535156 11.171875 6.320312 16.359375 6.320312 C 18.871094 6.320312 21.230469 7.296875 23.003906 9.074219 C 24.78125 10.851562 25.757812 13.214844 25.757812 15.726562 C 25.753906 20.914062 21.535156 25.132812 16.355469 25.132812 Z M 21.511719 18.089844 C 21.230469 17.945312 19.839844 17.261719 19.582031 17.167969 C 19.320312 17.074219 19.132812 17.027344 18.945312 17.3125 C 18.757812 17.59375 18.214844 18.230469 18.050781 18.417969 C 17.882812 18.609375 17.71875 18.632812 17.4375 18.488281 C 17.152344 18.347656 16.242188 18.050781 15.164062 17.085938 C 14.324219 16.335938 13.757812 15.410156 13.589844 15.128906 C 13.425781 14.84375 13.574219 14.691406 13.714844 14.550781 C 13.84375 14.425781 13.996094 14.222656 14.140625 14.054688 C 14.28125 13.890625 14.328125 13.773438 14.421875 13.585938 C 14.515625 13.394531 14.46875 13.230469 14.398438 13.089844 C 14.328125 12.949219 13.761719 11.554688 13.527344 10.992188 C 13.296875 10.441406 13.066406 10.515625 12.890625 10.503906 C 12.726562 10.496094 12.539062 10.496094 12.347656 10.496094 C 12.160156 10.496094 11.855469 10.566406 11.59375 10.847656 C 11.335938 11.132812 10.605469 11.816406 10.605469 13.207031 C 10.605469 14.597656 11.617188 15.941406 11.761719 16.132812 C 11.902344 16.320312 13.753906 19.175781 16.589844 20.398438 C 17.261719 20.691406 17.789062 20.863281 18.199219 20.996094 C 18.878906 21.210938 19.492188 21.179688 19.980469 21.105469 C 20.523438 21.027344 21.652344 20.421875 21.890625 19.761719 C 22.125 19.101562 22.125 18.535156 22.054688 18.417969 C 21.984375 18.300781 21.792969 18.230469 21.511719 18.089844 Z M 21.511719 18.089844 "/>
</g>
</svg>

          <p>Email</p>
        </a>
      </li>
      

      
      
      <li>
        <a href="mailto:?subject=Tutorial%20for%20CIoT%20Open%20Data%20Applications - 4.1.%20Time%20Series%20Data%20Processing.&amp;body=4.1.%20Time%20Series%20Data%20Processing%2c%20by%20Tutorial%20for%20CIoT%20Open%20Data%20Applications%0aWe%20use%20the%20sensing%20data%20of%20Civil%20IoT%20Taiwan%20Data%20Service%20Platform%20to%20guide%20readers%20to%20understand%20the%20use%20of%20moving%20average%2c%20perform%20periodic%20analysis%20of%20time%20series%20data%2c%20and%20then%20disassemble%20the%20time%20series%20data%20into%20long-term%20trends%2c%20seasonal%20changes%20and%20residual%20fluctuations.%20At%20the%20same%20time%2c%20we%20apply%20the%20existing%20Python%20language%20suites%20to%20perform%20change%20point%20detection%20and%20outlier%20detection%20to%20check%20the%20existing%20Civil%20IoT%20Taiwan%20data%2c%20and%20discuss%20potential%20implications%20of%20such%20values%20detected.%0a%0ahttps%3a%2f%2fLearnCIOT.github.io%2fen%2fch4%2fch4.1%2f%0a" target="_blank" class="share-btn email">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32px" height="32px" viewBox="0 0 32 32" version="1.1">
<defs>
<filter id="alpha" filterUnits="objectBoundingBox" x="0%" y="0%" width="100%" height="100%">
  <feColorMatrix type="matrix" in="SourceGraphic" values="0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0"/>
</filter>
<mask id="mask0">
  <g filter="url(#alpha)">
<rect x="0" y="0" width="32" height="32" style="fill:rgb(0%,0%,0%);fill-opacity:0.2;stroke:none;"/>
  </g>
</mask>
<clipPath id="clip1">
  <rect x="0" y="0" width="32" height="32"/>
</clipPath>
<g id="surface5" clip-path="url(#clip1)">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(13.72549%,12.156863%,12.54902%);fill-opacity:1;" d="M 26 22 C 26 23.101562 25.101562 24 24 24 L 8 24 C 6.898438 24 6 23.101562 6 22 L 6 12 C 6 10.898438 6.898438 10 8 10 L 24 10 C 25.101562 10 26 10.898438 26 12 Z M 26 22 "/>
</g>
<mask id="mask1">
  <g filter="url(#alpha)">
<rect x="0" y="0" width="32" height="32" style="fill:rgb(0%,0%,0%);fill-opacity:0.2;stroke:none;"/>
  </g>
</mask>
<clipPath id="clip2">
  <rect x="0" y="0" width="32" height="32"/>
</clipPath>
<g id="surface8" clip-path="url(#clip2)">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(13.72549%,12.156863%,12.54902%);fill-opacity:1;" d="M 17.75 15.101562 C 16.800781 14.050781 15.199219 14.050781 14.25 15.101562 L 6.5 21.601562 C 6.398438 21.699219 6.351562 21.800781 6.25 21.898438 C 6.601562 22.550781 7.25 23 7.949219 23 L 23.949219 23 C 24.699219 23 25.300781 22.550781 25.648438 21.898438 C 25.601562 21.800781 25.5 21.699219 25.398438 21.601562 Z M 17.75 15.101562 "/>
</g>
<mask id="mask2">
  <g filter="url(#alpha)">
<rect x="0" y="0" width="32" height="32" style="fill:rgb(0%,0%,0%);fill-opacity:0.2;stroke:none;"/>
  </g>
</mask>
<clipPath id="clip3">
  <rect x="0" y="0" width="32" height="32"/>
</clipPath>
<g id="surface11" clip-path="url(#clip3)">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(13.72549%,12.156863%,12.54902%);fill-opacity:1;" d="M 6.300781 10.101562 C 6.648438 9.449219 7.300781 9 8 9 L 24 9 C 24.75 9 25.351562 9.449219 25.699219 10.101562 C 25.648438 10.199219 25.550781 10.300781 25.449219 10.398438 L 17.75 16.898438 C 16.800781 17.949219 15.199219 17.949219 14.25 16.898438 Z M 6.300781 10.101562 "/>
</g>
</defs>
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(46.666667%,70.196078%,83.137255%);fill-opacity:1;" d="M 32 16 C 32 24.835938 24.835938 32 16 32 C 7.164062 32 0 24.835938 0 16 C 0 7.164062 7.164062 0 16 0 C 24.835938 0 32 7.164062 32 16 Z M 32 16 "/>
<use xlink:href="#surface5" mask="url(#mask0)"/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(87.843137%,87.843137%,81.960784%);fill-opacity:1;" d="M 26 21 C 26 22.101562 25.101562 23 24 23 L 8 23 C 6.898438 23 6 22.101562 6 21 L 6 11 C 6 9.898438 6.898438 9 8 9 L 24 9 C 25.101562 9 26 9.898438 26 11 Z M 26 21 "/>
<use xlink:href="#surface8" mask="url(#mask1)"/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(87.843137%,87.843137%,81.960784%);fill-opacity:1;" d="M 17.75 16 C 16.800781 15.050781 15.199219 15.050781 14.25 16 L 6.5 21.75 C 6.398438 21.851562 6.351562 21.898438 6.25 22 C 6.601562 22.601562 7.25 22.949219 7.949219 22.949219 L 23.949219 22.949219 C 24.699219 22.949219 25.300781 22.550781 25.648438 22 C 25.601562 21.898438 25.5 21.851562 25.398438 21.75 Z M 17.75 16 "/>
<use xlink:href="#surface11" mask="url(#mask2)"/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 14.25 16 C 15.199219 16.949219 16.800781 16.949219 17.75 16 L 25.5 10.25 C 25.601562 10.148438 25.648438 10.101562 25.75 10 C 25.398438 9.398438 24.75 9.050781 24.050781 9.050781 L 8 9.050781 C 7.25 9.050781 6.648438 9.449219 6.300781 10 C 6.351562 10.101562 6.449219 10.148438 6.550781 10.25 Z M 14.25 16 "/>
</g>
</svg>

          <p>Email</p>
        </a>
      </li>
    </ul>
  </section>
  


          <article class="default">
<h1>4.1. Time Series Data Processing</h1>

<p><a href="https://colab.research.google.com/drive/1MUHXiRiI7o56oZLCU2JrxI-aJEiM6RkJ?usp=sharing"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>
<div>
    <h2>Table Of Contents</h2>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#goal">Goal</a></li>
    <li><a href="#package-installation-and-importing">Package Installation and Importing</a></li>
    <li><a href="#data-access">Data Access</a>
      <ul>
        <li><a href="#air-quality-data">Air Quality Data</a></li>
        <li><a href="#water-level-data">Water Level Data</a></li>
        <li><a href="#meteorological-data">Meteorological Data</a></li>
      </ul>
    </li>
    <li><a href="#data-visualization">Data Visualization</a>
      <ul>
        <li><a href="#data-resample">Data Resample</a></li>
        <li><a href="#moving-average">Moving Average</a></li>
        <li><a href="#multi-line-charts">Multi-line Charts</a></li>
        <li><a href="#calendar-heatmap">Calendar Heatmap</a></li>
      </ul>
    </li>
    <li><a href="#data-quality-inspection">Data Quality Inspection</a>
      <ul>
        <li><a href="#outlier-detection">Outlier Detection</a></li>
        <li><a href="#change-point-detection">Change Point Detection)</a></li>
        <li><a href="#missing-data-handling">Missing Data Handling</a></li>
      </ul>
    </li>
    <li><a href="#data-decomposition">Data Decomposition</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
</div>

<p>Time series data is data formed in the order of appearance in time. Usually, the time interval in the data will be the same (for example, one data every five minutes, or one data per hour), and the application fields are quite wide, such as financial information, space engineering, signal processing, etc. There are also many statistical related tools that can used in analysis. In addition, time series data is very close to everyday life. For example, with the intensification of global climate change, the global average temperature has become higher and higher in recent years, and the summer is unbearably hot. Also, certain seasons of the year tend to have particularly poor air quality, or certain times of the year tend to have worse air quality than others. If you want to know more about these changes in living environment, and how the corresponding sensor values change, you will need to use time series data analysis, which is to observe the relationship between data and time, and then get the results. This chapter will demonstrate using three types of data (air quality, water resources, weather) in the Civil IoT Taiwan Data Service Platform.</p>
<h2 id="goal">Goal</h2>
<ul>
<li>observe time series data using visualization tools</li>
<li>check and process time series data</li>
<li>decompose time series data to investigate its trend and seasonality</li>
</ul>
<h2 id="package-installation-and-importing">Package Installation and Importing</h2>
<p>In this article, we will use the pandas, matplotlib, numpy, seaborn, statsmodels, and warnings packages, which are pre-installed on our development platform, Google Colab, and do not need to be installed manually. However, we will also use two additional packages that Colab does not have pre-installed: kats and calplot, which need to be installed by :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install <span style="color:#f92672">--</span>upgrade pip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Kats</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install kats<span style="color:#f92672">==</span><span style="color:#ae81ff">0.1</span> ax<span style="color:#f92672">-</span>platform<span style="color:#f92672">==</span><span style="color:#ae81ff">0.2.3</span> statsmodels<span style="color:#f92672">==</span><span style="color:#ae81ff">0.12.2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># calplot</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>pip install calplot
</span></span></code></pre></div><p>After the installation is complete, we can use the following syntax to import the relevant packages to complete the preparations in this article.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> warnings
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> calplot
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib <span style="color:#66d9ef">as</span> mpl
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> statsmodels.api <span style="color:#66d9ef">as</span> sm
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os<span style="color:#f92672">,</span> zipfile
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime, timedelta
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dateutil <span style="color:#f92672">import</span> parser <span style="color:#66d9ef">as</span> datetime_parser
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> statsmodels.tsa.stattools <span style="color:#f92672">import</span> adfuller, kpss
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> statsmodels.tsa.seasonal <span style="color:#f92672">import</span> seasonal_decompose
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> kats.detectors.outlier <span style="color:#f92672">import</span> OutlierDetector
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> kats.detectors.cusum_detection <span style="color:#f92672">import</span> CUSUMDetector
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> kats.consts <span style="color:#f92672">import</span> TimeSeriesData, TimeSeriesIterator
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> IPython.core.pylabtools <span style="color:#f92672">import</span> figsize
</span></span></code></pre></div><h2 id="data-access">Data Access</h2>
<p>We use pandas for data processing. Pandas is a data science suite commonly used in Python language. It can also be thought of as a spreadsheet similar to Microsoft Excel in a programming language, and its Dataframe object provided by pandas can be thought of as a two-dimensional data structure. The dimensional data structure can store data in rows and columns, which is convenient for various data processing and operations.</p>
<p>The topic of this paper is the analysis and processing of time series data. We will use the air quality, water level and meteorological data on the Civil IoT Taiwan Data Service Platform for data access demonstration, and then use the air quality data for further data analysis. Among them, each type of data is the data observed by a collection of stations for a long time, and the time field name in the dataframe is set to <code>timestamp</code>. Because the value of the time field is unique, we also use this field as the index of the dataframe.</p>
<h3 id="air-quality-data">Air Quality Data</h3>
<p>Since we want to use long-term historical data in this article, we do not directly use the data access methods of the pyCIOT package, but directly download the data archive of &ldquo;Academia Sinica - Micro Air Quality Sensors&rdquo; from the historical database of the Civil IoT Taiwan Data Service Platform and store in the <code>Air</code> folder.</p>
<p>At the same time, since the downloaded data is in the format of a zip compressed file, we need to decompress it to generate a number of compressed daily file, and then decompress the compressed daily file and store it in the <code>CSV_Air</code> folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>mkdir Air CSV_Air
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Air<span style="color:#f92672">/</span><span style="color:#ae81ff">2018.</span>zip <span style="color:#f92672">-</span>q <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2Bepuuawo%2BWTgeizqi</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">kuK3noJTpmaJf5qCh5ZyS56m65ZOB5b6u5Z6L5oSf5ris5ZmoLzIwMTguemlw&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Air<span style="color:#f92672">/</span><span style="color:#ae81ff">2019.</span>zip <span style="color:#f92672">-</span>q <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2Bepuuawo%2BWTgeizqi</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">kuK3noJTpmaJf5qCh5ZyS56m65ZOB5b6u5Z6L5oSf5ris5ZmoLzIwMTkuemlw&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Air<span style="color:#f92672">/</span><span style="color:#ae81ff">2020.</span>zip <span style="color:#f92672">-</span>q <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2Bepuuawo%2BWTgeizqi</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">kuK3noJTpmaJf5qCh5ZyS56m65ZOB5b6u5Z6L5oSf5ris5ZmoLzIwMjAuemlw&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Air<span style="color:#f92672">/</span><span style="color:#ae81ff">2021.</span>zip <span style="color:#f92672">-</span>q <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2Bepuuawo%2BWTgeizqi</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">kuK3noJTpmaJf5qCh5ZyS56m65ZOB5b6u5Z6L5oSf5ris5ZmoLzIwMjEuemlw&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#開始進行解壓縮</span>
</span></span><span style="display:flex;"><span>folder <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Air&#39;</span>
</span></span><span style="display:flex;"><span>extension_zip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;.zip&#39;</span>
</span></span><span style="display:flex;"><span>extension_csv <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;.csv&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> subfolder <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(folder):
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>folder<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>subfolder<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> path<span style="color:#f92672">.</span>endswith(extension_zip):
</span></span><span style="display:flex;"><span>      print(path)
</span></span><span style="display:flex;"><span>      zip_ref <span style="color:#f92672">=</span> zipfile<span style="color:#f92672">.</span>ZipFile(path)
</span></span><span style="display:flex;"><span>      zip_ref<span style="color:#f92672">.</span>extractall(folder)
</span></span><span style="display:flex;"><span>      zip_ref<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> subfolder <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(folder):
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>folder<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>subfolder<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(path):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(path):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> item<span style="color:#f92672">.</span>endswith(extension_zip):
</span></span><span style="display:flex;"><span>                file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>path<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>                print(file_name)
</span></span><span style="display:flex;"><span>                zip_ref <span style="color:#f92672">=</span> zipfile<span style="color:#f92672">.</span>ZipFile(file_name)
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>extractall(path)
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(path):
</span></span><span style="display:flex;"><span>          path2 <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>path<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(path2):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> it <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(path2):
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">if</span> it<span style="color:#f92672">.</span>endswith(extension_zip):
</span></span><span style="display:flex;"><span>                file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>path2<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>it<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>                print(file_name)
</span></span><span style="display:flex;"><span>                zip_ref <span style="color:#f92672">=</span> zipfile<span style="color:#f92672">.</span>ZipFile(file_name)
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>extractall(<span style="color:#e6db74">&#39;CSV_Air&#39;</span>) <span style="color:#75715e"># decide path</span>
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">elif</span> item<span style="color:#f92672">.</span>endswith(extension_csv):
</span></span><span style="display:flex;"><span>            os<span style="color:#f92672">.</span>rename(path2, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;CSV_Air/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span></code></pre></div><p>The CSV_Air folder now contains all daily sensor data in CSV format. To filter out data for a single station (such as the station with code <code>74DA38C7D2AC</code>), we need to read each CSV file and put the data for that station into a dataframe called <code>air</code>. Finally, we delete all downloaded data and data generated after decompression to save storage space in the cloud.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>folder <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;CSV_Air&#39;</span>
</span></span><span style="display:flex;"><span>extension_csv <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;.csv&#39;</span>
</span></span><span style="display:flex;"><span>id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;74DA38C7D2AC&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>air <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(folder):
</span></span><span style="display:flex;"><span>  file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>folder<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>  df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(file_name)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;pm25&#39;</span> <span style="color:#f92672">in</span> list(df<span style="color:#f92672">.</span>columns):
</span></span><span style="display:flex;"><span>    df<span style="color:#f92672">.</span>rename({<span style="color:#e6db74">&#39;pm25&#39;</span>:<span style="color:#e6db74">&#39;PM25&#39;</span>}, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>  filtered <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>query(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;device_id==@id&#39;</span>)
</span></span><span style="display:flex;"><span>  air <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([air, filtered], ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>air<span style="color:#f92672">.</span>dropna(subset<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;timestamp&#39;</span>], inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, row <span style="color:#f92672">in</span> air<span style="color:#f92672">.</span>iterrows():
</span></span><span style="display:flex;"><span>  aware <span style="color:#f92672">=</span> datetime_parser<span style="color:#f92672">.</span>parse(str(row[<span style="color:#e6db74">&#39;timestamp&#39;</span>]))
</span></span><span style="display:flex;"><span>  naive <span style="color:#f92672">=</span> aware<span style="color:#f92672">.</span>replace(tzinfo<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>  air<span style="color:#f92672">.</span>at[i, <span style="color:#e6db74">&#39;timestamp&#39;</span>] <span style="color:#f92672">=</span> naive
</span></span><span style="display:flex;"><span>air<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;timestamp&#39;</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>rm <span style="color:#f92672">-</span>rf Air CSV_Air
</span></span></code></pre></div><p>Finally, we rearrange the data in the site, delete unnecessary field information, and sort them by time as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>air<span style="color:#f92672">.</span>drop(columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;device_id&#39;</span>, <span style="color:#e6db74">&#39;SiteName&#39;</span>], inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>air<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;timestamp&#39;</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>air<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span>print(air<span style="color:#f92672">.</span>head())
</span></span></code></pre></div><pre tabindex="0"><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 195305 entries, 2018-08-01 00:00:05 to 2021-12-31 23:54:46
Data columns (total 1 columns):
 \#   Column  Non-Null Count   Dtype 
---  ------  --------------   ----- 
 0   PM25    195305 non-null  object
dtypes: object(1)
memory usage: 3.0+ MB
                     PM25
timestamp                
2018-08-01 00:00:05  20.0
2018-08-01 00:30:18  17.0
2018-08-01 01:12:34  18.0
2018-08-01 01:18:36  21.0
2018-08-01 01:30:44  22.0
</code></pre><h3 id="water-level-data">Water Level Data</h3>
<p>Like the example of air quality data, since we are going to use long-term historical data this time, we do not directly use the data access methods of the pyCIOT suite, but directly download the data archive of &ldquo;Water Resources Agency - Groundwater Level Station&rdquo; from the historical database of the Civil IoT Taiwan Data Service Platform and store in the <code>Water</code> folder.</p>
<p>At the same time, since the downloaded data is in the format of a zip compressed file, we need to decompress it to generate a number of compressed daily file, and then decompress the compressed daily file and store it in the <code>CSV_Water</code> folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>mkdir Water CSV_Water
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Water<span style="color:#f92672">/</span><span style="color:#ae81ff">2018.</span>zip <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2BawtOizh%2Ba6kC</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">msLTliKnnvbJf5rKz5bed5rC05L2N56uZLzIwMTguemlw&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Water<span style="color:#f92672">/</span><span style="color:#ae81ff">2019.</span>zip <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2BawtOizh%2Ba6kC</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">msLTliKnnvbJf5rKz5bed5rC05L2N56uZLzIwMTkuemlw&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Water<span style="color:#f92672">/</span><span style="color:#ae81ff">2020.</span>zip <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2BawtOizh%2Ba6kC</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">msLTliKnnvbJf5rKz5bed5rC05L2N56uZLzIwMjAuemlw&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Water<span style="color:#f92672">/</span><span style="color:#ae81ff">2021.</span>zip <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2BawtOizh%2Ba6kC</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">msLTliKnnvbJf5rKz5bed5rC05L2N56uZLzIwMjEuemlw&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#開始進行解壓縮</span>
</span></span><span style="display:flex;"><span>folder <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Water&#39;</span>
</span></span><span style="display:flex;"><span>extension_zip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;.zip&#39;</span>
</span></span><span style="display:flex;"><span>extension_csv <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;.csv&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> subfolder <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(folder):
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>folder<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>subfolder<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> path<span style="color:#f92672">.</span>endswith(extension_zip):
</span></span><span style="display:flex;"><span>      print(path)
</span></span><span style="display:flex;"><span>      zip_ref <span style="color:#f92672">=</span> zipfile<span style="color:#f92672">.</span>ZipFile(path)
</span></span><span style="display:flex;"><span>      zip_ref<span style="color:#f92672">.</span>extractall(folder)
</span></span><span style="display:flex;"><span>      zip_ref<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> subfolder <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(folder):
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>folder<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>subfolder<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(path):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(path):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> item<span style="color:#f92672">.</span>endswith(extension_zip):
</span></span><span style="display:flex;"><span>                file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>path<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>                print(file_name)
</span></span><span style="display:flex;"><span>                zip_ref <span style="color:#f92672">=</span> zipfile<span style="color:#f92672">.</span>ZipFile(file_name)
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>extractall(path)
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(path):
</span></span><span style="display:flex;"><span>          path2 <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>path<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(path2):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> it <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(path2):
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">if</span> it<span style="color:#f92672">.</span>endswith(extension_zip) <span style="color:#f92672">and</span> <span style="color:#f92672">not</span> it<span style="color:#f92672">.</span>endswith(<span style="color:#e6db74">&#39;QC.zip&#39;</span>):
</span></span><span style="display:flex;"><span>                file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>path2<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>it<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>                print(file_name)
</span></span><span style="display:flex;"><span>                zip_ref <span style="color:#f92672">=</span> zipfile<span style="color:#f92672">.</span>ZipFile(file_name)
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>extractall(<span style="color:#e6db74">&#39;CSV_Water&#39;</span>) <span style="color:#75715e"># decide path</span>
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">elif</span> item<span style="color:#f92672">.</span>endswith(extension_csv):
</span></span><span style="display:flex;"><span>            os<span style="color:#f92672">.</span>rename(path2, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;CSV_Water/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span></code></pre></div><p>The CSV_Water folder now contains all daily sensor data in CSV format. To filter out data for a single station (such as the station with code <code>338c9c1c-57d8-41d7-9af2-731fb86e632c</code>), we need to read each CSV file and put the data for that station into a dataframe called <code>water</code>. Finally, we delete all downloaded data and data generated after decompression to save storage space in the cloud.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>folder <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;CSV_Water&#39;</span>
</span></span><span style="display:flex;"><span>extension_csv <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;.csv&#39;</span>
</span></span><span style="display:flex;"><span>id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;338c9c1c-57d8-41d7-9af2-731fb86e632c&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>water <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(folder):
</span></span><span style="display:flex;"><span>  file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>folder<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>  df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(file_name)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;pm25&#39;</span> <span style="color:#f92672">in</span> list(df<span style="color:#f92672">.</span>columns):
</span></span><span style="display:flex;"><span>    df<span style="color:#f92672">.</span>rename({<span style="color:#e6db74">&#39;pm25&#39;</span>:<span style="color:#e6db74">&#39;PM25&#39;</span>}, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>  filtered <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>query(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;station_id==@id&#39;</span>)
</span></span><span style="display:flex;"><span>  water <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([water, filtered], ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>water<span style="color:#f92672">.</span>dropna(subset<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;timestamp&#39;</span>], inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, row <span style="color:#f92672">in</span> water<span style="color:#f92672">.</span>iterrows():
</span></span><span style="display:flex;"><span>  aware <span style="color:#f92672">=</span> datetime_parser<span style="color:#f92672">.</span>parse(str(row[<span style="color:#e6db74">&#39;timestamp&#39;</span>]))
</span></span><span style="display:flex;"><span>  naive <span style="color:#f92672">=</span> aware<span style="color:#f92672">.</span>replace(tzinfo<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>  water<span style="color:#f92672">.</span>at[i, <span style="color:#e6db74">&#39;timestamp&#39;</span>] <span style="color:#f92672">=</span> naive
</span></span><span style="display:flex;"><span>water<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;timestamp&#39;</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>rm <span style="color:#f92672">-</span>rf Water CSV_Water
</span></span></code></pre></div><p>Finally, we rearrange the data in the site, delete unnecessary field information, and sort them by time as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>water<span style="color:#f92672">.</span>drop(columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;station_id&#39;</span>, <span style="color:#e6db74">&#39;ciOrgname&#39;</span>, <span style="color:#e6db74">&#39;ciCategory&#39;</span>, <span style="color:#e6db74">&#39;Organize_Name&#39;</span>, <span style="color:#e6db74">&#39;CategoryInfos_Name&#39;</span>, <span style="color:#e6db74">&#39;PQ_name&#39;</span>, <span style="color:#e6db74">&#39;PQ_fullname&#39;</span>, <span style="color:#e6db74">&#39;PQ_description&#39;</span>, <span style="color:#e6db74">&#39;PQ_unit&#39;</span>, <span style="color:#e6db74">&#39;PQ_id&#39;</span>], inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>water<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;timestamp&#39;</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>water<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span>print(water<span style="color:#f92672">.</span>head())
</span></span></code></pre></div><pre tabindex="0"><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 213466 entries, 2018-01-01 00:20:00 to 2021-12-07 11:00:00
Data columns (total 1 columns):
 #   Column  Non-Null Count   Dtype  
---  ------  --------------   -----  
 0   value   213465 non-null  float64
dtypes: float64(1)
memory usage: 3.3 MB
                         value
timestamp                     
2018-01-01 00:20:00  49.130000
2018-01-01 00:25:00  49.139999
2018-01-01 00:30:00  49.130001
2018-01-01 00:35:00  49.130001
2018-01-01 00:40:00  49.130001
</code></pre><h3 id="meteorological-data">Meteorological Data</h3>
<p>We download the data archive of &ldquo;Central Weather Bureau - Automatic Weather Station&rdquo; from the historical database of the Civil IoT Taiwan Data Service Platform and store in the <code>Weather</code> folder.</p>
<p>At the same time, since the downloaded data is in the format of a zip compressed file, we need to decompress it to generate a number of compressed daily file, and then decompress the compressed daily file and store it in the <code>CSV_Weather</code> folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>mkdir Weather CSV_Weather
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Weather<span style="color:#f92672">/</span><span style="color:#ae81ff">2019.</span>zip <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2Bawo%2BixoS</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">kuK3lpK7msKPosaHlsYBf6Ieq5YuV5rCj6LGh56uZLzIwMTkuemlw&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Weather<span style="color:#f92672">/</span><span style="color:#ae81ff">2020.</span>zip <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2Bawo%2BixoS</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">kuK3lpK7msKPosaHlsYBf6Ieq5YuV5rCj6LGh56uZLzIwMjAuemlw&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>wget <span style="color:#f92672">-</span>O Weather<span style="color:#f92672">/</span><span style="color:#ae81ff">2021.</span>zip <span style="color:#e6db74">&#34;https://history.colife.org.tw/?r=/download&amp;path=L%2Bawo%2BixoS</span><span style="color:#e6db74">%2F</span><span style="color:#e6db74">kuK3lpK7msKPosaHlsYBf6Ieq5YuV5rCj6LGh56uZLzIwMjEuemlw&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#開始進行解壓縮</span>
</span></span><span style="display:flex;"><span>folder <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Weather&#39;</span>
</span></span><span style="display:flex;"><span>extension_zip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;.zip&#39;</span>
</span></span><span style="display:flex;"><span>extension_csv <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;.csv&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> subfolder <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(folder):
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>folder<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>subfolder<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> path<span style="color:#f92672">.</span>endswith(extension_zip):
</span></span><span style="display:flex;"><span>      print(path)
</span></span><span style="display:flex;"><span>      zip_ref <span style="color:#f92672">=</span> zipfile<span style="color:#f92672">.</span>ZipFile(path)
</span></span><span style="display:flex;"><span>      zip_ref<span style="color:#f92672">.</span>extractall(folder)
</span></span><span style="display:flex;"><span>      zip_ref<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> subfolder <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(folder):
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>folder<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>subfolder<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(path):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(path):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> item<span style="color:#f92672">.</span>endswith(extension_zip):
</span></span><span style="display:flex;"><span>                file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>path<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>                print(file_name)
</span></span><span style="display:flex;"><span>                zip_ref <span style="color:#f92672">=</span> zipfile<span style="color:#f92672">.</span>ZipFile(file_name)
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>extractall(path)
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(path):
</span></span><span style="display:flex;"><span>          path2 <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>path<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isdir(path2):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> it <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(path2):
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">if</span> it<span style="color:#f92672">.</span>endswith(extension_zip):
</span></span><span style="display:flex;"><span>                file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>path2<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>it<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>                print(file_name)
</span></span><span style="display:flex;"><span>                zip_ref <span style="color:#f92672">=</span> zipfile<span style="color:#f92672">.</span>ZipFile(file_name)
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>extractall(<span style="color:#e6db74">&#39;CSV_Weather&#39;</span>) <span style="color:#75715e"># decide path</span>
</span></span><span style="display:flex;"><span>                zip_ref<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">elif</span> item<span style="color:#f92672">.</span>endswith(extension_csv):
</span></span><span style="display:flex;"><span>            os<span style="color:#f92672">.</span>rename(path2, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;CSV_Weather/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span></code></pre></div><p>The CSV_Weather folder now contains all daily sensor data in CSV format. To filter out data for a single station (such as the station with code <code>C0U750</code>), we need to read each CSV file and put the data for that station into a dataframe called <code>weather</code>. Finally, we delete all downloaded data and data generated after decompression to save storage space in the cloud.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>folder <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;CSV_Weather&#39;</span>
</span></span><span style="display:flex;"><span>extension_csv <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;.csv&#39;</span>
</span></span><span style="display:flex;"><span>id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;C0U750&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>weather <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> os<span style="color:#f92672">.</span>listdir(folder):
</span></span><span style="display:flex;"><span>  file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>folder<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>  df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(file_name)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;pm25&#39;</span> <span style="color:#f92672">in</span> list(df<span style="color:#f92672">.</span>columns):
</span></span><span style="display:flex;"><span>    df<span style="color:#f92672">.</span>rename({<span style="color:#e6db74">&#39;pm25&#39;</span>:<span style="color:#e6db74">&#39;PM25&#39;</span>}, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>  filtered <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>query(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;station_id==@id&#39;</span>)
</span></span><span style="display:flex;"><span>  weather <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([weather, filtered], ignore_index<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>weather<span style="color:#f92672">.</span>rename({<span style="color:#e6db74">&#39;obsTime&#39;</span>:<span style="color:#e6db74">&#39;timestamp&#39;</span>}, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>weather<span style="color:#f92672">.</span>dropna(subset<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;timestamp&#39;</span>], inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, row <span style="color:#f92672">in</span> weather<span style="color:#f92672">.</span>iterrows():
</span></span><span style="display:flex;"><span>  aware <span style="color:#f92672">=</span> datetime_parser<span style="color:#f92672">.</span>parse(str(row[<span style="color:#e6db74">&#39;timestamp&#39;</span>]))
</span></span><span style="display:flex;"><span>  naive <span style="color:#f92672">=</span> aware<span style="color:#f92672">.</span>replace(tzinfo<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>  weather<span style="color:#f92672">.</span>at[i, <span style="color:#e6db74">&#39;timestamp&#39;</span>] <span style="color:#f92672">=</span> naive
</span></span><span style="display:flex;"><span>weather<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;timestamp&#39;</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">!</span>rm <span style="color:#f92672">-</span>rf Weather CSV_Weather
</span></span></code></pre></div><p>Finally, we rearrange the data in the site, delete unnecessary field information, and sort them by time as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>weather<span style="color:#f92672">.</span>drop(columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;station_id&#39;</span>], inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>weather<span style="color:#f92672">.</span>sort_values(by<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;timestamp&#39;</span>, inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>weather<span style="color:#f92672">.</span>info()
</span></span><span style="display:flex;"><span>print(weather<span style="color:#f92672">.</span>head())
</span></span></code></pre></div><pre tabindex="0"><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 27093 entries, 2019-01-01 00:00:00 to 2021-12-31 23:00:00
Data columns (total 15 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   ELEV    27093 non-null  float64
 1   WDIR    27089 non-null  float64
 2   WDSD    27089 non-null  float64
 3   TEMP    27093 non-null  float64
 4   HUMD    27089 non-null  float64
 5   PRES    27093 non-null  float64
 6   SUN     13714 non-null  float64
 7   H_24R   27089 non-null  float64
 8   H_FX    27089 non-null  float64
 9   H_XD    27089 non-null  object 
 10  H_FXT   23364 non-null  object 
 11  D_TX    27074 non-null  object 
 12  D_TXT   7574 non-null   object 
 13  D_TN    27074 non-null  object 
 14  D_TNT   17 non-null     object 
dtypes: float64(9), object(6)
memory usage: 3.3+ MB
                      ELEV  WDIR  WDSD  TEMP  HUMD   PRES   SUN  H_24R  H_FX  \
timestamp                                                                      
2019-01-01 00:00:00  398.0  35.0   5.8  13.4  0.99  981.1 -99.0   18.5 -99.0   
2019-01-01 01:00:00  398.0  31.0   5.7  14.1  0.99  981.0 -99.0    0.5  10.8   
2019-01-01 02:00:00  398.0  35.0   5.3  13.9  0.99  980.7 -99.0    1.0 -99.0   
2019-01-01 03:00:00  398.0  32.0   5.7  13.8  0.99  980.2 -99.0    1.5 -99.0   
2019-01-01 04:00:00  398.0  37.0   6.9  13.8  0.99  980.0 -99.0    2.0  12.0   

                     H_XD H_FXT  D_TX D_TXT  D_TN D_TNT  
timestamp                                                
2019-01-01 00:00:00 -99.0 -99.0  14.5   NaN  13.4   NaN  
2019-01-01 01:00:00  35.0   NaN  14.1   NaN  13.5   NaN  
2019-01-01 02:00:00 -99.0 -99.0  14.1   NaN  13.5   NaN  
2019-01-01 03:00:00 -99.0 -99.0  14.1   NaN  13.5   NaN  
2019-01-01 04:00:00  39.0   NaN  14.1   NaN  13.5   NaN
</code></pre><p>Above, we have successfully demonstrated the reading example of air quality data (air), water level data (water) and meteorological data (weather). In the following discussion, we will use air quality data to demonstrate basic time series data processing. The same methods can also be easily applied to water level data or meteorological data and obtain similar results. You are encouraged to try it yourself.</p>
<h2 id="data-visualization">Data Visualization</h2>
<p>The first step in the processing of time series data is nothing more than to present the information one by one in chronological order so that users can see the changes in the overall data and derive more ideas and concepts for data analysis. Among them, using line charts to display data is the most commonly used data visualization method. For example, take the air quality data as an example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">10</span>), dpi<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(air[:][<span style="color:#e6db74">&#34;PM25&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Date&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;PM2.5&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;PM2.5 Time Series Plot&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/4-1-3-1.png" alt="Python output"></p>
<h3 id="data-resample">Data Resample</h3>
<p>As can be seen from the air quality data sequence diagram in the above figure, the distribution of data is actually very dense, and the changes in data values are sometimes small and violent. This is because the current sampling frequency of air quality data is about once every five minutes, and the collected environment is the surrounding environment information in life, so data density and fluctuation are inevitable. Because sampling every 5 minutes is too frequent, it is difficult to show general trends in ambient air pollution. Therefore, we adopt the method of resampling to calculate the average value of the data in a fixed time interval, so as to present the data of different time scales. For example, we use the following syntax to resample at a larger scale (hour, day, month) sampling rate according to the characteristics of the existing air quality data:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>air_hour <span style="color:#f92672">=</span> air<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#39;H&#39;</span>)<span style="color:#f92672">.</span>mean() <span style="color:#75715e"># hourly average</span>
</span></span><span style="display:flex;"><span>air_day <span style="color:#f92672">=</span> air<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#39;D&#39;</span>)<span style="color:#f92672">.</span>mean()  <span style="color:#75715e"># daily average</span>
</span></span><span style="display:flex;"><span>air_month <span style="color:#f92672">=</span> air<span style="color:#f92672">.</span>resample(<span style="color:#e6db74">&#39;M&#39;</span>)<span style="color:#f92672">.</span>mean()  <span style="color:#75715e"># monthly average</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(air_hour<span style="color:#f92672">.</span>head())
</span></span><span style="display:flex;"><span>print(air_day<span style="color:#f92672">.</span>head())
</span></span><span style="display:flex;"><span>print(air_month<span style="color:#f92672">.</span>head())
</span></span></code></pre></div><pre tabindex="0"><code>                         PM25
timestamp                     
2018-08-01 00:00:00  18.500000
2018-08-01 01:00:00  20.750000
2018-08-01 02:00:00  24.000000
2018-08-01 03:00:00  27.800000
2018-08-01 04:00:00  22.833333
                 PM25
timestamp            
2018-08-01  23.384615
2018-08-02  13.444444
2018-08-03  14.677419
2018-08-04  14.408451
2018-08-05        NaN
                 PM25
timestamp            
2018-08-31  21.704456
2018-09-30  31.797806
2018-10-31  37.217788
2018-11-30  43.228939
</code></pre><p>Then we plot again with the hourly averaged resampling data, and we can see that the curve becomes clearer, but the fluctuation of the curve is still very large.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">10</span>), dpi<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(air_hour[:][<span style="color:#e6db74">&#34;PM25&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Date&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#34;PM2.5&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;PM2.5 Time Series Plot&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/4-1-3-2.png" alt="Python output"></p>
<h3 id="moving-average">Moving Average</h3>
<p>For the chart of the original data, if you want to see a smoother change trend of the curve, you can apply the moving average method. The idea is to set a sampling window on the time axis of the original data, move the position of the sampling window smoothly, and calculate the average value of all values in the sampling window.</p>
<p>For example, if the size of the sampling window is 10, it means that the current data and the previous 9 data are averaged each time. After such processing, the meaning of each data is not only a certain time point, but the average value of the original time point and the previous time point. This removes abrupt changes and makes the overall curve smoother, thereby making it easier to observe overall trends.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># plt.figure(figsize=(15, 10), dpi=60)</span>
</span></span><span style="display:flex;"><span>MA <span style="color:#f92672">=</span> air_hour
</span></span><span style="display:flex;"><span>MA10 <span style="color:#f92672">=</span> MA<span style="color:#f92672">.</span>rolling(window<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>, min_periods<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>mean()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MA<span style="color:#f92672">.</span>join(MA10<span style="color:#f92672">.</span>add_suffix(<span style="color:#e6db74">&#39;_mean_500&#39;</span>))<span style="color:#f92672">.</span>plot(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span><span style="color:#75715e"># MA10.plot(figsize(15, 10))</span>
</span></span></code></pre></div><p><img src="figures/4-1-3-3.png" alt="Python output"></p>
<p>The blue line in the above figure is the original data, and the orange line is the curve after moving average. It can be clearly found that the orange line can better represent the change trend of the overall value, and there is also a certain degree of regular fluctuation, which is worthy of further analysis.</p>
<h3 id="multi-line-charts">Multi-line Charts</h3>
<p>In addition to presenting the original data in the form of a simple line chart, another common data visualization method is to cut the data into several continuous segments periodically in the time dimension, draw line charts separately, and superimpose them on the same multi-line chart. For example, we can cut the above air quality data into four sub-data sets of 2019, 2020, 2021, and 2022 according to different years, and draw their respective line charts on the same multi-line chart, as shown in the figure below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>air_month<span style="color:#f92672">.</span>reset_index(inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>air_month[<span style="color:#e6db74">&#39;year&#39;</span>] <span style="color:#f92672">=</span> [d<span style="color:#f92672">.</span>year <span style="color:#66d9ef">for</span> d <span style="color:#f92672">in</span> air_month<span style="color:#f92672">.</span>timestamp]
</span></span><span style="display:flex;"><span>air_month[<span style="color:#e6db74">&#39;month&#39;</span>] <span style="color:#f92672">=</span> [d<span style="color:#f92672">.</span>strftime(<span style="color:#e6db74">&#39;%b&#39;</span>) <span style="color:#66d9ef">for</span> d <span style="color:#f92672">in</span> air_month<span style="color:#f92672">.</span>timestamp]
</span></span><span style="display:flex;"><span>years <span style="color:#f92672">=</span> air_month[<span style="color:#e6db74">&#39;year&#39;</span>]<span style="color:#f92672">.</span>unique()
</span></span><span style="display:flex;"><span>print(air)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>seed(<span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>mycolors <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>choice(list(mpl<span style="color:#f92672">.</span>colors<span style="color:#f92672">.</span>XKCD_COLORS<span style="color:#f92672">.</span>keys()), len(years), replace<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">10</span>), dpi<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, y <span style="color:#f92672">in</span> enumerate(years):
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(<span style="color:#e6db74">&#39;month&#39;</span>, <span style="color:#e6db74">&#39;PM25&#39;</span>, data<span style="color:#f92672">=</span>air_month<span style="color:#f92672">.</span>loc[air_month<span style="color:#f92672">.</span>year<span style="color:#f92672">==</span>y, :], color<span style="color:#f92672">=</span>mycolors[i], label<span style="color:#f92672">=</span>y)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>text(air_month<span style="color:#f92672">.</span>loc[air_month<span style="color:#f92672">.</span>year<span style="color:#f92672">==</span>y, :]<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">-</span><span style="color:#ae81ff">.9</span>, air_month<span style="color:#f92672">.</span>loc[air_month<span style="color:#f92672">.</span>year<span style="color:#f92672">==</span>y, <span style="color:#e6db74">&#39;PM25&#39;</span>][<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:]<span style="color:#f92672">.</span>values[<span style="color:#ae81ff">0</span>], y, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>, color<span style="color:#f92672">=</span>mycolors[i])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plt.gca().set(xlim=(-0.3, 11), ylim=(2, 30), ylabel=&#39;PM25&#39;, xlabel=&#39;Month&#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plt.yticks(fontsize=12, alpha=.7)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plt.title(&#39;Seasonal Plot of PM25 Time Series&#39;, fontsize=20)</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/4-1-3-4.png" alt="Python output"></p>
<p>In this multi-line chart, we can see that the 2019 data has a significant portion of missing values, while the 2022 data was only recorded till July at the time of writing. At the same time, it can be found that in the four-year line chart, the curves of different years all reached the lowest point in summer, began to rise in autumn, and reached the highest point in winter, showing roughly the same trend of change.</p>
<h3 id="calendar-heatmap">Calendar Heatmap</h3>
<p>The calendar heat map is a data visualization method that combines the calendar map and the heat map, which can more intuitively browse the distribution of the data and find the regularity of different time scales. We use calplot, a calendar heatmap suite for Python, and input the daily PM2.5 averages. Then we select the specified color (the parameter name is <code>cmap</code>, and we set it to <code>GnBu</code> in the following example. for detailed color options, please refer to the reference materials), and we can get the effect of the following figure, in which blue represents the greater value, green or white means lower values, if not colored or a value of 0 means there is no data for the day. From the resulting plot, we can see that the months in the middle part (summer) are lighter and the months in the left part (winter) are darker, just in line with our previous observations using the multi-line chart.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># cmap: color map (https://matplotlib.org/stable/gallery/color/colormap_reference.html)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># textformat: specify the format of the text</span>
</span></span><span style="display:flex;"><span>pl1 <span style="color:#f92672">=</span> calplot<span style="color:#f92672">.</span>calplot(data <span style="color:#f92672">=</span> air_day[<span style="color:#e6db74">&#39;PM25&#39;</span>], cmap <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;GnBu&#39;</span>, textformat <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{:.0f}</span><span style="color:#e6db74">&#39;</span>, 
</span></span><span style="display:flex;"><span>											figsize <span style="color:#f92672">=</span> (<span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">12</span>), suptitle <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PM25 by Month and Year&#34;</span>)
</span></span></code></pre></div><p><img src="figures/4-1-3-5.png" alt="Python output"></p>
<h2 id="data-quality-inspection">Data Quality Inspection</h2>
<p>After the basic visualization of time series data, we will introduce the basic detection and processing methods of data quality. We will use kats, a Python language data processing and analysis suite, to perform outlier detection, change point detection, and handling missing values in sequence.</p>
<h3 id="outlier-detection">Outlier Detection</h3>
<p>Outliers are those values in the data that are significantly different from other values. These differences may affect our judgment and analysis of the data. Therefore, outliers need to be identified and then flagged, removed, or treated specially. .</p>
<p>We first convert the data stored in the variable <code>air_hour</code> from its original dataframe format to the <code>TimeSeriesData</code> format used by the kats package and save the converted data into a variable named <code>air_ts</code>. Then we re-plot the line chart of the time series data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>air_ts <span style="color:#f92672">=</span> TimeSeriesData(air_hour<span style="color:#f92672">.</span>reset_index(), time_col_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;timestamp&#39;</span>)
</span></span><span style="display:flex;"><span>air_ts<span style="color:#f92672">.</span>plot(cols<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;PM25&#34;</span>])
</span></span></code></pre></div><p><img src="figures/4-1-4-1.png" alt="Python output"></p>
<p>We then used the <code>OutlierDetector</code> tool in the kats suite to detect outliers in the time series data, where outliers were less than 1.5 times the first quartile (Q1) minus the interquartile range (IQR) or greater than The third quartile (Q3) value plus 1.5 times the interquartile range.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>outlierDetection <span style="color:#f92672">=</span> OutlierDetector(air_ts, <span style="color:#e6db74">&#39;additive&#39;</span>)
</span></span><span style="display:flex;"><span>outlierDetection<span style="color:#f92672">.</span>detector()
</span></span><span style="display:flex;"><span>outlierDetection<span style="color:#f92672">.</span>outliers
</span></span></code></pre></div><pre tabindex="0"><code>[[Timestamp(&#39;2018-08-10 16:00:00&#39;),
  Timestamp(&#39;2018-08-10 17:00:00&#39;),
  Timestamp(&#39;2018-08-20 00:00:00&#39;),
  Timestamp(&#39;2018-08-23 03:00:00&#39;),
  Timestamp(&#39;2018-08-23 04:00:00&#39;),
  Timestamp(&#39;2018-09-02 11:00:00&#39;),
  Timestamp(&#39;2018-09-11 00:00:00&#39;),
  Timestamp(&#39;2018-09-13 14:00:00&#39;),
  Timestamp(&#39;2018-09-13 15:00:00&#39;),
  Timestamp(&#39;2018-09-13 16:00:00&#39;),
  Timestamp(&#39;2018-09-15 08:00:00&#39;),
  Timestamp(&#39;2018-09-15 09:00:00&#39;),
  Timestamp(&#39;2018-09-15 10:00:00&#39;),
  Timestamp(&#39;2018-09-15 11:00:00&#39;),
  Timestamp(&#39;2018-09-22 05:00:00&#39;),
  Timestamp(&#39;2018-09-22 06:00:00&#39;),
  Timestamp(&#39;2018-10-26 01:00:00&#39;),
  Timestamp(&#39;2018-11-06 13:00:00&#39;),
  Timestamp(&#39;2018-11-06 15:00:00&#39;),
  Timestamp(&#39;2018-11-06 16:00:00&#39;),
  Timestamp(&#39;2018-11-06 19:00:00&#39;),
  Timestamp(&#39;2018-11-06 20:00:00&#39;),
  Timestamp(&#39;2018-11-06 21:00:00&#39;),
  Timestamp(&#39;2018-11-06 22:00:00&#39;),
  Timestamp(&#39;2018-11-07 07:00:00&#39;),
  Timestamp(&#39;2018-11-07 08:00:00&#39;),
  Timestamp(&#39;2018-11-07 09:00:00&#39;),
  Timestamp(&#39;2018-11-09 00:00:00&#39;),
  Timestamp(&#39;2018-11-09 01:00:00&#39;),
  Timestamp(&#39;2018-11-09 02:00:00&#39;),
  Timestamp(&#39;2018-11-09 03:00:00&#39;),
  Timestamp(&#39;2018-11-10 02:00:00&#39;),
  Timestamp(&#39;2018-11-10 03:00:00&#39;),
  Timestamp(&#39;2018-11-16 01:00:00&#39;),
  Timestamp(&#39;2018-11-16 02:00:00&#39;),
  Timestamp(&#39;2018-11-16 03:00:00&#39;),
  Timestamp(&#39;2018-11-16 04:00:00&#39;),
  Timestamp(&#39;2018-11-21 00:00:00&#39;),
  Timestamp(&#39;2018-11-21 18:00:00&#39;),
  Timestamp(&#39;2018-11-21 19:00:00&#39;),
  Timestamp(&#39;2018-11-25 08:00:00&#39;),
  Timestamp(&#39;2018-11-30 14:00:00&#39;),
  Timestamp(&#39;2018-12-01 06:00:00&#39;),
  Timestamp(&#39;2018-12-01 16:00:00&#39;),
  Timestamp(&#39;2018-12-01 17:00:00&#39;),
  Timestamp(&#39;2018-12-15 02:00:00&#39;),
  Timestamp(&#39;2018-12-19 03:00:00&#39;),
  Timestamp(&#39;2018-12-19 04:00:00&#39;),
  Timestamp(&#39;2018-12-19 05:00:00&#39;),
  Timestamp(&#39;2018-12-19 06:00:00&#39;),
  Timestamp(&#39;2018-12-19 07:00:00&#39;),
  Timestamp(&#39;2018-12-19 08:00:00&#39;),
  Timestamp(&#39;2018-12-19 10:00:00&#39;),
  Timestamp(&#39;2018-12-19 11:00:00&#39;),
  Timestamp(&#39;2018-12-19 12:00:00&#39;),
  Timestamp(&#39;2018-12-19 13:00:00&#39;),
  Timestamp(&#39;2018-12-19 14:00:00&#39;),
  Timestamp(&#39;2018-12-19 15:00:00&#39;),
  Timestamp(&#39;2018-12-19 16:00:00&#39;),
  Timestamp(&#39;2018-12-19 17:00:00&#39;),
  Timestamp(&#39;2018-12-20 03:00:00&#39;),
  Timestamp(&#39;2018-12-20 04:00:00&#39;),
  Timestamp(&#39;2018-12-20 05:00:00&#39;),
  Timestamp(&#39;2018-12-20 06:00:00&#39;),
  Timestamp(&#39;2018-12-20 07:00:00&#39;),
  Timestamp(&#39;2018-12-20 08:00:00&#39;),
  Timestamp(&#39;2018-12-20 11:00:00&#39;),
  Timestamp(&#39;2018-12-20 12:00:00&#39;),
  Timestamp(&#39;2018-12-20 13:00:00&#39;),
  Timestamp(&#39;2018-12-20 14:00:00&#39;),
  Timestamp(&#39;2018-12-20 15:00:00&#39;),
  Timestamp(&#39;2019-01-05 02:00:00&#39;),
  Timestamp(&#39;2019-01-05 08:00:00&#39;),
  Timestamp(&#39;2019-01-05 09:00:00&#39;),
  Timestamp(&#39;2019-01-05 22:00:00&#39;),
  Timestamp(&#39;2019-01-19 06:00:00&#39;),
  Timestamp(&#39;2019-01-19 07:00:00&#39;),
  Timestamp(&#39;2019-01-19 08:00:00&#39;),
  Timestamp(&#39;2019-01-19 09:00:00&#39;),
  Timestamp(&#39;2019-01-19 13:00:00&#39;),
  Timestamp(&#39;2019-01-19 14:00:00&#39;),
  Timestamp(&#39;2019-01-19 15:00:00&#39;),
  Timestamp(&#39;2019-01-25 18:00:00&#39;),
  Timestamp(&#39;2019-01-25 19:00:00&#39;),
  Timestamp(&#39;2019-01-25 20:00:00&#39;),
  Timestamp(&#39;2019-01-26 00:00:00&#39;),
  Timestamp(&#39;2019-01-26 01:00:00&#39;),
  Timestamp(&#39;2019-01-26 02:00:00&#39;),
  Timestamp(&#39;2019-01-26 03:00:00&#39;),
  Timestamp(&#39;2019-01-26 04:00:00&#39;),
  Timestamp(&#39;2019-01-30 06:00:00&#39;),
  Timestamp(&#39;2019-01-30 11:00:00&#39;),
  Timestamp(&#39;2019-01-30 12:00:00&#39;),
  Timestamp(&#39;2019-01-30 13:00:00&#39;),
  Timestamp(&#39;2019-01-30 14:00:00&#39;),
  Timestamp(&#39;2019-02-02 16:00:00&#39;),
  Timestamp(&#39;2019-02-02 17:00:00&#39;),
  Timestamp(&#39;2019-02-02 18:00:00&#39;),
  Timestamp(&#39;2019-02-02 19:00:00&#39;),
  Timestamp(&#39;2019-02-02 20:00:00&#39;),
  Timestamp(&#39;2019-02-03 03:00:00&#39;),
  Timestamp(&#39;2019-02-03 04:00:00&#39;),
  Timestamp(&#39;2019-02-03 05:00:00&#39;),
  Timestamp(&#39;2019-02-03 06:00:00&#39;),
  Timestamp(&#39;2019-02-03 07:00:00&#39;),
  Timestamp(&#39;2019-02-03 10:00:00&#39;),
  Timestamp(&#39;2019-02-03 11:00:00&#39;),
  Timestamp(&#39;2019-02-03 12:00:00&#39;),
  Timestamp(&#39;2019-02-03 13:00:00&#39;),
  Timestamp(&#39;2019-02-03 22:00:00&#39;),
  Timestamp(&#39;2019-02-03 23:00:00&#39;),
  Timestamp(&#39;2019-02-07 05:00:00&#39;),
  Timestamp(&#39;2019-02-07 06:00:00&#39;),
  Timestamp(&#39;2019-02-16 22:00:00&#39;),
  Timestamp(&#39;2019-02-16 23:00:00&#39;),
  Timestamp(&#39;2019-02-18 18:00:00&#39;),
  Timestamp(&#39;2019-02-18 20:00:00&#39;),
  Timestamp(&#39;2019-02-18 21:00:00&#39;),
  Timestamp(&#39;2019-02-19 10:00:00&#39;),
  Timestamp(&#39;2019-02-19 11:00:00&#39;),
  Timestamp(&#39;2019-02-19 12:00:00&#39;),
  Timestamp(&#39;2019-02-19 13:00:00&#39;),
  Timestamp(&#39;2019-02-19 14:00:00&#39;),
  Timestamp(&#39;2019-02-19 15:00:00&#39;),
  Timestamp(&#39;2019-02-19 16:00:00&#39;),
  Timestamp(&#39;2019-02-19 23:00:00&#39;),
  Timestamp(&#39;2019-02-20 00:00:00&#39;),
  Timestamp(&#39;2019-02-20 03:00:00&#39;),
  Timestamp(&#39;2019-03-02 17:00:00&#39;),
  Timestamp(&#39;2019-03-03 06:00:00&#39;),
  Timestamp(&#39;2019-03-05 13:00:00&#39;),
  Timestamp(&#39;2019-03-09 23:00:00&#39;),
  Timestamp(&#39;2019-03-12 01:00:00&#39;),
  Timestamp(&#39;2019-03-16 01:00:00&#39;),
  Timestamp(&#39;2019-03-16 02:00:00&#39;),
  Timestamp(&#39;2019-03-16 03:00:00&#39;),
  Timestamp(&#39;2019-03-20 00:00:00&#39;),
  Timestamp(&#39;2019-03-20 01:00:00&#39;),
  Timestamp(&#39;2019-03-20 02:00:00&#39;),
  Timestamp(&#39;2019-03-20 03:00:00&#39;),
  Timestamp(&#39;2019-03-20 11:00:00&#39;),
  Timestamp(&#39;2019-03-27 00:00:00&#39;),
  Timestamp(&#39;2019-03-27 01:00:00&#39;),
  Timestamp(&#39;2019-04-05 03:00:00&#39;),
  Timestamp(&#39;2019-04-18 17:00:00&#39;),
  Timestamp(&#39;2019-04-20 16:00:00&#39;),
  Timestamp(&#39;2019-05-10 07:00:00&#39;),
  Timestamp(&#39;2019-05-22 20:00:00&#39;),
  Timestamp(&#39;2019-05-23 03:00:00&#39;),
  Timestamp(&#39;2019-05-23 16:00:00&#39;),
  Timestamp(&#39;2019-05-26 18:00:00&#39;),
  Timestamp(&#39;2019-05-27 05:00:00&#39;),
  Timestamp(&#39;2019-07-28 01:00:00&#39;),
  Timestamp(&#39;2019-08-23 08:00:00&#39;),
  Timestamp(&#39;2019-08-24 02:00:00&#39;),
  Timestamp(&#39;2019-08-24 03:00:00&#39;),
  Timestamp(&#39;2019-08-24 04:00:00&#39;),
  Timestamp(&#39;2019-08-24 05:00:00&#39;),
  Timestamp(&#39;2019-08-24 07:00:00&#39;),
  Timestamp(&#39;2019-08-24 08:00:00&#39;),
  Timestamp(&#39;2019-12-10 11:00:00&#39;),
  Timestamp(&#39;2019-12-10 12:00:00&#39;),
  Timestamp(&#39;2019-12-10 13:00:00&#39;),
  Timestamp(&#39;2019-12-10 20:00:00&#39;),
  Timestamp(&#39;2019-12-11 04:00:00&#39;),
  Timestamp(&#39;2019-12-16 20:00:00&#39;),
  Timestamp(&#39;2019-12-17 11:00:00&#39;),
  Timestamp(&#39;2020-01-03 15:00:00&#39;),
  Timestamp(&#39;2020-01-05 08:00:00&#39;),
  Timestamp(&#39;2020-01-05 09:00:00&#39;),
  Timestamp(&#39;2020-01-06 08:00:00&#39;),
  Timestamp(&#39;2020-01-07 10:00:00&#39;),
  Timestamp(&#39;2020-01-07 15:00:00&#39;),
  Timestamp(&#39;2020-01-10 11:00:00&#39;),
  Timestamp(&#39;2020-01-15 08:00:00&#39;),
  Timestamp(&#39;2020-01-22 14:00:00&#39;),
  Timestamp(&#39;2020-01-22 17:00:00&#39;),
  Timestamp(&#39;2020-01-22 22:00:00&#39;),
  Timestamp(&#39;2020-01-22 23:00:00&#39;),
  Timestamp(&#39;2020-01-23 00:00:00&#39;),
  Timestamp(&#39;2020-01-23 01:00:00&#39;),
  Timestamp(&#39;2020-01-23 02:00:00&#39;),
  Timestamp(&#39;2020-01-23 10:00:00&#39;),
  Timestamp(&#39;2020-01-23 11:00:00&#39;),
  Timestamp(&#39;2020-01-23 12:00:00&#39;),
  Timestamp(&#39;2020-01-23 13:00:00&#39;),
  Timestamp(&#39;2020-01-23 15:00:00&#39;),
  Timestamp(&#39;2020-01-23 16:00:00&#39;),
  Timestamp(&#39;2020-01-23 17:00:00&#39;),
  Timestamp(&#39;2020-01-23 18:00:00&#39;),
  Timestamp(&#39;2020-01-23 20:00:00&#39;),
  Timestamp(&#39;2020-01-23 21:00:00&#39;),
  Timestamp(&#39;2020-01-23 22:00:00&#39;),
  Timestamp(&#39;2020-01-23 23:00:00&#39;),
  Timestamp(&#39;2020-01-24 00:00:00&#39;),
  Timestamp(&#39;2020-01-24 01:00:00&#39;),
  Timestamp(&#39;2020-01-24 02:00:00&#39;),
  Timestamp(&#39;2020-01-24 03:00:00&#39;),
  Timestamp(&#39;2020-02-12 10:00:00&#39;),
  Timestamp(&#39;2020-02-12 11:00:00&#39;),
  Timestamp(&#39;2020-02-12 12:00:00&#39;),
  Timestamp(&#39;2020-02-12 13:00:00&#39;),
  Timestamp(&#39;2020-02-12 14:00:00&#39;),
  Timestamp(&#39;2020-02-12 19:00:00&#39;),
  Timestamp(&#39;2020-02-12 20:00:00&#39;),
  Timestamp(&#39;2020-02-12 22:00:00&#39;),
  Timestamp(&#39;2020-02-12 23:00:00&#39;),
  Timestamp(&#39;2020-02-13 20:00:00&#39;),
  Timestamp(&#39;2020-02-14 00:00:00&#39;),
  Timestamp(&#39;2020-02-14 01:00:00&#39;),
  Timestamp(&#39;2020-02-15 10:00:00&#39;),
  Timestamp(&#39;2020-02-19 08:00:00&#39;),
  Timestamp(&#39;2020-02-19 09:00:00&#39;),
  Timestamp(&#39;2020-02-19 10:00:00&#39;),
  Timestamp(&#39;2020-02-25 02:00:00&#39;),
  Timestamp(&#39;2020-02-25 03:00:00&#39;),
  Timestamp(&#39;2020-03-09 07:00:00&#39;),
  Timestamp(&#39;2020-03-18 21:00:00&#39;),
  Timestamp(&#39;2020-03-18 22:00:00&#39;),
  Timestamp(&#39;2020-03-19 01:00:00&#39;),
  Timestamp(&#39;2020-03-20 04:00:00&#39;),
  Timestamp(&#39;2020-03-21 09:00:00&#39;),
  Timestamp(&#39;2020-03-21 10:00:00&#39;),
  Timestamp(&#39;2020-03-28 22:00:00&#39;),
  Timestamp(&#39;2020-04-15 03:00:00&#39;),
  Timestamp(&#39;2020-04-28 03:00:00&#39;),
  Timestamp(&#39;2020-04-28 04:00:00&#39;),
  Timestamp(&#39;2020-05-01 13:00:00&#39;),
  Timestamp(&#39;2020-05-01 15:00:00&#39;),
  Timestamp(&#39;2020-05-01 23:00:00&#39;),
  Timestamp(&#39;2020-05-02 00:00:00&#39;),
  Timestamp(&#39;2020-11-17 14:00:00&#39;),
  Timestamp(&#39;2020-11-17 20:00:00&#39;),
  Timestamp(&#39;2020-11-17 21:00:00&#39;),
  Timestamp(&#39;2020-11-17 22:00:00&#39;),
  Timestamp(&#39;2020-11-18 19:00:00&#39;),
  Timestamp(&#39;2020-11-18 20:00:00&#39;),
  Timestamp(&#39;2020-11-18 23:00:00&#39;),
  Timestamp(&#39;2020-11-19 00:00:00&#39;),
  Timestamp(&#39;2020-11-19 01:00:00&#39;),
  Timestamp(&#39;2020-12-21 15:00:00&#39;),
  Timestamp(&#39;2020-12-27 14:00:00&#39;),
  Timestamp(&#39;2020-12-27 15:00:00&#39;),
  Timestamp(&#39;2020-12-27 16:00:00&#39;),
  Timestamp(&#39;2020-12-27 21:00:00&#39;),
  Timestamp(&#39;2021-01-16 09:00:00&#39;),
  Timestamp(&#39;2021-01-16 10:00:00&#39;),
  Timestamp(&#39;2021-01-16 11:00:00&#39;),
  Timestamp(&#39;2021-02-01 10:00:00&#39;),
  Timestamp(&#39;2021-02-03 09:00:00&#39;),
  Timestamp(&#39;2021-02-03 10:00:00&#39;),
  Timestamp(&#39;2021-02-06 11:00:00&#39;),
  Timestamp(&#39;2021-02-06 17:00:00&#39;),
  Timestamp(&#39;2021-02-08 11:00:00&#39;),
  Timestamp(&#39;2021-02-11 14:00:00&#39;),
  Timestamp(&#39;2021-02-25 22:00:00&#39;),
  Timestamp(&#39;2021-03-12 08:00:00&#39;),
  Timestamp(&#39;2021-03-19 15:00:00&#39;),
  Timestamp(&#39;2021-03-19 20:00:00&#39;),
  Timestamp(&#39;2021-03-29 13:00:00&#39;),
  Timestamp(&#39;2021-04-06 07:00:00&#39;),
  Timestamp(&#39;2021-04-12 15:00:00&#39;),
  Timestamp(&#39;2021-04-13 16:00:00&#39;),
  Timestamp(&#39;2021-11-04 14:00:00&#39;),
  Timestamp(&#39;2021-11-04 15:00:00&#39;),
  Timestamp(&#39;2021-11-04 23:00:00&#39;),
  Timestamp(&#39;2021-11-05 00:00:00&#39;),
  Timestamp(&#39;2021-11-05 01:00:00&#39;),
  Timestamp(&#39;2021-11-05 05:00:00&#39;),
  Timestamp(&#39;2021-11-05 06:00:00&#39;),
  Timestamp(&#39;2021-11-05 11:00:00&#39;),
  Timestamp(&#39;2021-11-05 15:00:00&#39;),
  Timestamp(&#39;2021-11-28 15:00:00&#39;),
  Timestamp(&#39;2021-11-29 10:00:00&#39;),
  Timestamp(&#39;2021-12-21 11:00:00&#39;)]]
</code></pre><p>Finally, we delete the detected outliers from the original data, and re-plot the chart to compare it with the original one. We can clearly find some outliers (for example, there is an abnormal peak in 2022-07) have been removed.</p>
<pre tabindex="0"><code>outliers_removed = outlierDetection.remover(interpolate=False)
outliers_removed
outliers_removed.plot(cols=[&#39;y_0&#39;])
</code></pre><p><img src="figures/4-1-4-2.png" alt="Python output"></p>
<h3 id="change-point-detection">Change Point Detection)</h3>
<p>A change point is a point in time at which the data suddenly changes significantly, representing the occurrence of an event, a change in the state of the data, or a change in the distribution of the data. Therefore, change point detection is often regarded as an important preprocessing step for data analysis and data prediction.</p>
<p>In the following example, we use daily averages of air quality data for change point detection. We use the <code>TimeSeriesData</code> data format of the kats package to store the data and use the <code>CUSUMDetector</code> detector provided by kats for detection. We use red dots to represent detected change points in the plot. Unfortunately, in this example, no obvious point of change was observed. Readers are advised to refer to this example and bring in other data for more exercise and testing.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>air_ts <span style="color:#f92672">=</span> TimeSeriesData(air_day<span style="color:#f92672">.</span>reset_index(), time_col_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;timestamp&#39;</span>)
</span></span><span style="display:flex;"><span>detector <span style="color:#f92672">=</span> CUSUMDetector(air_ts)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>change_points <span style="color:#f92672">=</span> detector<span style="color:#f92672">.</span>detector(change_directions<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;increase&#34;</span>, <span style="color:#e6db74">&#34;decrease&#34;</span>])
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(&#34;The change point is on&#34;, change_points[0][0].start_time)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plot the results</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xticks(rotation<span style="color:#f92672">=</span><span style="color:#ae81ff">45</span>)
</span></span><span style="display:flex;"><span>detector<span style="color:#f92672">.</span>plot(change_points)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/4-1-4-3.png" alt="Python output"></p>
<h3 id="missing-data-handling">Missing Data Handling</h3>
<p>Missing data is a common problem when conducting big data analysis. Some of these missing values are already missing at the time of data collection (such as sensor failure, network disconnection, etc.), and some are eliminated during data preprocessing (outliers or abnormality). However, for subsequent data processing and analysis, we often need the data to maintain a fixed sampling rate to facilitate the application of various methods and tools. Therefore, various methods for imputing missing data have been derived. Below we introduce three commonly used methods:</p>
<ol>
<li>Mark missing data as Nan (Not a number): Nan stands for not a number and is used to represent undefined or unrepresentable values. If it is known that subsequent data analysis will additionally deal with these special cases of Nan, this method can be adopted to maintain the authenticity of the information.</li>
<li>Forward filling method: If Nan has difficulty in subsequent data analysis, missing values must be filled with appropriate numerical data. The easiest way to do this is forward fill, which uses the previous value to fill in the current missing value.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># forward fill</span>
</span></span><span style="display:flex;"><span>df_ffill <span style="color:#f92672">=</span> air<span style="color:#f92672">.</span>ffill(inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>df_ffill<span style="color:#f92672">.</span>plot()
</span></span></code></pre></div><p><img src="figures/4-1-4-4.png" alt="Python output">
3. K-Nearest Neighbor (KNN) method: As the name suggests, the KNN method finds the k values that are closest to the missing value, and then fills the missing value with the average of these k values.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">knn_mean</span>(ts, n):
</span></span><span style="display:flex;"><span>    out <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>copy(ts)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i, val <span style="color:#f92672">in</span> enumerate(ts):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> np<span style="color:#f92672">.</span>isnan(val):
</span></span><span style="display:flex;"><span>            n_by_2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>ceil(n<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>            lower <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>max([<span style="color:#ae81ff">0</span>, int(i<span style="color:#f92672">-</span>n_by_2)])
</span></span><span style="display:flex;"><span>            upper <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>min([len(ts)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, int(i<span style="color:#f92672">+</span>n_by_2)])
</span></span><span style="display:flex;"><span>            ts_near <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>concatenate([ts[lower:i], ts[i:upper]])
</span></span><span style="display:flex;"><span>            out[i] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>nanmean(ts_near)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> out
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># KNN</span>
</span></span><span style="display:flex;"><span>df_knn <span style="color:#f92672">=</span> air<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>df_knn[<span style="color:#e6db74">&#39;PM25&#39;</span>] <span style="color:#f92672">=</span> knn_mean(air<span style="color:#f92672">.</span>PM25<span style="color:#f92672">.</span>to_numpy(), <span style="color:#ae81ff">5000</span>)
</span></span><span style="display:flex;"><span>df_knn<span style="color:#f92672">.</span>plot()
</span></span></code></pre></div><p><img src="figures/4-1-4-5.png" alt="Python output"></p>
<h2 id="data-decomposition">Data Decomposition</h2>
<p>In the previous example of basic data processing, we have been able to roughly observe the changing trend of data values and discover potential regular changes. In order to further explore the regularity of time series data changes, we introduce the data decomposition method. In this way, the original time series data can be disassembled into trend waves (trend), periodic waves (seasonal) and residual waves (residual).</p>
<p>We first replicated the daily average data of air quality data as <code>air_process</code> and processed the missing data using forward filling. Then, we first presented the raw data directly in the form of a line chart.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>air_process <span style="color:#f92672">=</span> air_day<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># new.round(1).head(12)</span>
</span></span><span style="display:flex;"><span>air_process<span style="color:#f92672">.</span>ffill(inplace<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>air_process<span style="color:#f92672">.</span>plot()
</span></span></code></pre></div><p><img src="figures/4-1-5-1.png" alt="Python output"></p>
<p>Then we use the <code>seasonal_decompose</code> method to decompose the <code>air_process</code> data, in which we need to set a period parameter, which refers to the period in which the data is decomposed. We first set it to 30 days, and then after execution, it will produce four pictures in sequence: raw data, trend chart, seasonal chart, and residual chart.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>decompose <span style="color:#f92672">=</span> seasonal_decompose(air_process[<span style="color:#e6db74">&#39;PM25&#39;</span>],model<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;additive&#39;</span>, period<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>)
</span></span><span style="display:flex;"><span>decompose<span style="color:#f92672">.</span>plot()<span style="color:#f92672">.</span>set_size_inches((<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/4-1-5-2.png" alt="Python output"></p>
<p>In the trend graph (trend), we can also find that the graph of the original data has very similar characteristics, with higher values around January and lower values around July; while in the seasonal graph (seasonal), we can find that the data has a fixed periodic change in each cycle (30 days), which means that the air quality data has a one-month change.</p>
<p>If we change the periodic variable to 365, i.e. decompose the data on a larger time scale (one year), we can see a trend of higher values around January and lower values around July from the seasonal plot, and this trend change occurs on a regular and regular basis. At the same time, it can be seen from the trend chart that the overall trend is slowing down, indicating that the concentration of PM2.5 is gradually decreasing under the overall trend. The results also confirmed our previous findings that no change points were detected, as the change trend of PM2.5 was a steady decline without abrupt changes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>decompose <span style="color:#f92672">=</span> seasonal_decompose(air_process[<span style="color:#e6db74">&#39;PM25&#39;</span>],model<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;additive&#39;</span>, period<span style="color:#f92672">=</span><span style="color:#ae81ff">365</span>)
</span></span><span style="display:flex;"><span>decompose<span style="color:#f92672">.</span>plot()<span style="color:#f92672">.</span>set_size_inches((<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img src="figures/4-1-5-3.png" alt="Python output"></p>
<h2 id="references">References</h2>
<ul>
<li>Civil IoT Taiwan: Historical Data (<a href="https://history.colife.org.tw/#/">https://history.colife.org.tw/</a>)</li>
<li>Matplotlib - Colormap reference (<a href="https://matplotlib.org/stable/gallery/color/colormap_reference.html">https://matplotlib.org/stable/gallery/color/colormap_reference.html</a>)</li>
<li>Decomposition of time series - Wikipedia (<a href="https://en.wikipedia.org/wiki/Decomposition_of_time_series">https://en.wikipedia.org/wiki/Decomposition_of_time_series</a>)</li>
<li>Kats: a Generalizable Framework to Analyze Time Series Data in Python | by Khuyen Tran | Towards Data Science (<a href="https://towardsdatascience.com/kats-a-generalizable-framework-to-analyze-time-series-data-in-python-3c8d21efe057?gi=36d1c3d8372">https://towardsdatascience.com/kats-a-generalizable-framework-to-analyze-time-series-data-in-python-3c8d21efe057?gi=36d1c3d8372</a>)</li>
<li>Decomposition in Time Series Data | by Abhilasha Chourasia | Analytics Vidhya | Medium (<a href="https://medium.com/analytics-vidhya/decomposition-in-time-series-data-b20764946d63">https://medium.com/analytics-vidhya/decomposition-in-time-series-data-b20764946d63</a>)</li>
</ul>

            <footer class="footline">
            </footer>
          </article>

<hr><div class="fb-comments" data-href="https://LearnCIOT.github.io/en/ch4/ch4.1/" data-width="100%" data-numposts="5"></div>
        </div>
      </main>
    </div>
    <aside id="sidebar" class="default-animation showVisitedLinks">
      <div id="header-wrapper" class="default-animation">
        <div id="header" class="default-animation">
          <style>
            #logo svg,
            #logo svg * {
              color: #282828;
              color: var(--MENU-SECTIONS-BG-color);
              fill: #282828 !important;
              fill: var(--MENU-SECTIONS-BG-color) !important;
              opacity: .945;
            }
            a#logo {
              color: #282828;
              color: var(--MENU-SECTIONS-BG-color);
              font-family: 'Work Sans', 'Helvetica', 'Tahoma', 'Geneva', 'Arial', sans-serif;
              font-size: 30px;
              font-weight: 300;
              margin-top: -13px;
              max-width: 60%;
              text-transform: uppercase;
              width: 226px;
              white-space: nowrap;
            }
            a#logo:hover {
              color: #282828;
              color: var(--MENU-SECTIONS-BG-color);
            }
            #logo svg {
              margin-bottom: -20px;
              margin-left: -23.5px;
              width: 40.5%;
            }
            @media only all and (max-width: 59.938em) {
              a#logo {
                font-size: 25px;
                margin-top: -3px;
              }
              #logo svg {
                margin-bottom: -12px;
                margin-left: -23px;
              }
            }
            @media all and (-ms-high-contrast:none) {
              /* IE11s understanding of positioning is weird at best */
              a#logo {
                margin-top: -58px;
              }
              #logo svg {
                margin-bottom: -62px;
              }
            }
          </style>
          <a id="logo" href="/en/">
            Learn CIoT
          </a>

        </div>
        <div class="searchbox default-animation">
          <label class="a11y-only" for="search-by">Search</label>
          <i class="fas fa-search"></i>
          <input data-search-input id="search-by" type="search" placeholder="Search...">
          <span data-search-clear=""><i class="fas fa-times"></i></span>
        </div>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1667519924" defer></script>
        <script src="/js/lunr.min.js?1667519924" defer></script>
        <script src="/js/lunr.stemmer.support.min.js?1667519924" defer></script>
        <script src="/js/lunr.multi.min.js?1667519924" defer></script>
        <script src="/js/lunr.en.min.js?1667519924" defer></script>
        <script src="/js/search.js?1667519924" defer></script>
      </div>
      <div id="content-wrapper" class="highlightable">
        <ul class="topics">
          <li data-nav-id="/en/ch1/" title="1. Introduction" class="dd-item"><a href="/en/ch1/">1. Introduction<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch2/" title="2. Overview of the Materials" class="dd-item"><label for="section-8824f0908e4fd15c767980c76e6fd82a" ></label><a href="/en/ch2/">2. Overview of the Materials<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch2/ch2.1/" title="2.1. Material Architecture" class="dd-item"><a href="/en/ch2/ch2.1/">2.1. Material Architecture<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch2/ch2.2/" title="2.2. Material Tools" class="dd-item"><a href="/en/ch2/ch2.2/">2.2. Material Tools<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/ch3/" title="3. Data Access" class="dd-item"><label for="section-8b3bcaa38467a39b2570f38fd8603d10" ></label><a href="/en/ch3/">3. Data Access<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch3/ch3.1/" title="3.1. Basic Data Access Methods" class="dd-item"><a href="/en/ch3/ch3.1/">3.1. Basic Data Access Methods<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch3/ch3.2/" title="3.2. Data Access under Spatial or Temporal Conditions" class="dd-item"><a href="/en/ch3/ch3.2/">3.2. Data Access under Spatial or Temporal Conditions<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/ch4/" title="4. Time Series Data Analysis" class="dd-item parent"><label for="section-b911da0d9c15f301a7d3deea0e716021" ></label><a href="/en/ch4/">4. Time Series Data Analysis<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch4/ch4.1/" title="4.1. Time Series Data Processing" class="dd-item active"><a href="/en/ch4/ch4.1/">4.1. Time Series Data Processing<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/ch5/" title="5. Spatial Data Analysis" class="dd-item"><a href="/en/ch5/">5. Spatial Data Analysis<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch6/" title="6. Data Applications" class="dd-item"><label for="section-4be7f7872a5d83dfd50bf0f4ff5c2761" ></label><a href="/en/ch6/">6. Data Applications<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch6/ch6.3/" title="6.3. Joint Data Calibration" class="dd-item"><a href="/en/ch6/ch6.3/">6.3. Joint Data Calibration<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/ch7/" title="7. System Integration and Applications" class="dd-item"><label for="section-af7207ef140cc843a4d69557766c672f" ></label><a href="/en/ch7/">7. System Integration and Applications<i class="fas fa-check read-icon"></i></a><ul>
          <li data-nav-id="/en/ch7/ch7.1/" title="7.1. QGIS Application" class="dd-item"><a href="/en/ch7/ch7.1/">7.1. QGIS Application<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch7/ch7.2/" title="7.2. Tableau Application" class="dd-item"><a href="/en/ch7/ch7.2/">7.2. Tableau Application<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/en/ch7/ch7.3/" title="7.3. Leafmap Applications" class="dd-item"><a href="/en/ch7/ch7.3/">7.3. Leafmap Applications<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/en/about/" title="About" class="dd-item"><a href="/en/about/">About<i class="fas fa-check read-icon"></i></a></li>
        </ul>
        <div id="shortcuts">
          <div class="nav-title">More</div>
          <ul>
            <li><a class="padding" href="https://github.com/LearnCIOT/LearnCIOT.github.io"><i class='fab fa-fw fa-github'></i> GitHub repo</a></li>
            <li><a class="padding" href="/en/levels/"><i class='fas fa-fw fa-heartbeat'></i> Search by difficulty</a></li>
            <li><a class="padding" href="/en/tags/"><i class='fas fa-fw fa-tags'></i> Search by topics</a></li>
            <li><a class="padding" href="/en/authors/"><i class='fas fa-fw fa-users'></i> Search by authors</a></li>
          </ul>
        </div>
        <div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showLangSwitch showVisitedLinks showFooter"></div>
        <hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showLangSwitch showVisitedLinks showFooter"/>
        <div id="prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks showLangSwitch showVisitedLinks">
          <ul>
            <li id="select-language-container" class="footerLangSwitch showLangSwitch">
              <a class="padding select-container">
                <i class="fas fa-language fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <select id="select-language" onchange="location = baseUri + this.value;">
                    <option id="en" value="/en/ch4/ch4.1/" selected>English</option>
                    <option id="zh-tw" value="/ch4/ch4.1/">中文</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </a>
            </li>
            <li id="select-variant-container" class="footerVariantSwitch">
              <a class="padding select-container">
                <i class="fas fa-paint-brush fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <select id="select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                    <option id="relearn-light" value="relearn-light" selected>Relearn Light</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </a>
              <script>window.variants && variants.markSelectedVariant();</script>
            </li>
            <li class="footerVisitedLinks showVisitedLinks"><a class="padding" onclick="clearHistory();"><i class="fas fa-history fa-fw"></i> Clear History</a></li>
          </ul>
        </div>
        <div id="footer" class="footerFooter showFooter">
	    <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
        </div>
      </div>
    </aside>

    <script src="/js/clipboard.min.js?1667519924" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1667519924" defer></script>
    <script src="/js/featherlight.min.js?1667519924" defer></script>
    <script src="/js/jquery.svg.pan.zoom.js?1667519924" defer></script>
    <script src="/js/mermaid.min.js?1667519924" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/js/theme.js?1667519924" defer></script>
  </body>
</html>
